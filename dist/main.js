define((function(){return function(){"use strict";var e={326:function(e,t,s){s.r(t),s.d(t,{amoWidjetSelf:function(){return Wl},default:function(){return ql}});var i=s(242),l=s(396);const a={id:"myVue"};function o(e,t,s,i,o,d){const n=(0,l.up)("main-page");return(0,l.wg)(),(0,l.iD)("div",a,[(0,l.Wm)(n)])}var d=s(139);const n=e=>((0,l.dD)("data-v-5e12e487"),e=e(),(0,l.Cn)(),e),r={class:"container1"},c=n((()=>(0,l._)("div",{class:"header"},null,-1))),u={class:"content"},p={class:"top"},_={class:"btns"},h=n((()=>(0,l._)("label",{for:"grid"},null,-1))),g=n((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"white",d:"M12 19q-.425 0-.713-.288T11 18v-5H6q-.425 0-.713-.288T5 12q0-.425.288-.713T6 11h5V6q0-.425.288-.713T12 5q.425 0 .713.288T13 6v5h5q.425 0 .713.288T19 12q0 .425-.288.713T18 13h-5v5q0 .425-.288.713T12 19Z"})],-1))),v=[g],m={key:0,class:"bottom"},f={class:"links"},w=["disabled","onClick"],y={key:0,class:"spinner"},b=n((()=>(0,l._)("img",{src:"https://warehouse2.salesup.pro/images/spinner.gif",alt:"spinner"},null,-1))),k=[b],C={class:"path"},L={class:"categories grid"},P=["onClick"],D={class:"sls_row title"},W=n((()=>(0,l._)("div",{class:"name"},null,-1))),x={class:"value"},q=n((()=>(0,l._)("div",{class:"sls_row"},null,-1))),A={class:"products grid"},S={key:0,class:"text"},V={class:"sls_row title"},T=n((()=>(0,l._)("div",{class:"name"},null,-1))),F={class:"value"},z={class:"rows"},I={class:"sls_row"},H=n((()=>(0,l._)("div",{class:"name",style:{"font-weight":"500"}},"Тип :",-1))),Y={class:"value"},j={class:"sls_row"},O={class:"name",style:{"font-weight":"500"}},E={class:"value"},M={class:"sls_row",style:{"margin-left":"8px"}},B=n((()=>(0,l._)("div",{class:"name"},"НДС :",-1))),R={class:"value"},N={class:"sls_row",style:{"margin-left":"8px"}},U=n((()=>(0,l._)("div",{class:"name"},"НДС включен в цену :",-1))),Z={class:"value"},K={class:"sls_row"},G={class:"name",style:{"font-weight":"500"}},X=n((()=>(0,l._)("div",{class:"value"},null,-1))),J={class:"sls_row",style:{"margin-left":"8px"}},Q=n((()=>(0,l._)("div",{class:"name"},"Свободно для резерва:",-1))),ee={class:"value"},te={key:2,class:"sls_row"},se={class:"name",style:{"font-weight":"500"}},ie={class:"value"},le={key:4,class:"sls_row"},ae={class:"name"},oe={class:"value"},de={key:5,class:"sls_row"},ne={class:"name"},re={class:"value"},ce={class:"card_footer"},ue=["onUpdate:modelValue"],pe=["onClick"],_e=n((()=>(0,l._)("div",{class:"sls_row title"},[(0,l._)("div",{class:"name"}),(0,l._)("div",{class:"value"})],-1))),he={class:"rows"},ge=n((()=>(0,l._)("div",{class:"name"},null,-1))),ve=n((()=>(0,l._)("div",{class:"value"},null,-1))),me=[ge,ve],fe=n((()=>(0,l._)("div",{class:"card_footer"},[(0,l._)("div",{class:"sls_btn btn_green btn_del"}),(0,l._)("div",{class:"sls_btn btn_green btn_del"})],-1))),we=n((()=>(0,l._)("div",{class:"footer"},null,-1)));function ye(e,t,s,a,o,n){const g=(0,l.up)("AppInputSelect"),b=(0,l.up)("AppPaginator"),$=(0,l.up)("AppImagesCarusel"),ge=(0,l.up)("filters-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",{class:(0,d.C_)(["app",{for_dark:n.isDarkTheme}])},[(0,l._)("div",r,[c,(0,l._)("div",u,[(0,l._)("div",p,[(0,l.Wm)(g,{list:o.search.list,value:o.search.value,placeholder:"Добавление (поиск на складе по названию или артикулу)...",countLettersReq:3,disabled:n.disableAddToDeal,onChangeInputValue:n.getProductsAutocomplete,onSelect:t[0]||(t[0]=e=>n.addToLeadAutocomplete(e.id))},null,8,["list","value","placeholder","disabled","onChangeInputValue"]),(0,l._)("div",_,[(0,l.wy)((0,l._)("input",{type:"checkbox",class:"sls_checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>o.show_cards=e),id:"grid"},null,512),[[i.e8,o.show_cards]]),h,(0,l._)("div",{class:(0,d.C_)(["sls_btn",{sls_btn_disable:n.disableAddToDeal}]),id:"sls_btn_open_filter",onClick:t[2]||(t[2]=e=>n.disableAddToDeal?null:n.openModal())},v,2)])]),(0,l.Wm)(i.uT,{name:"rows"},{default:(0,l.w5)((()=>[o.show_cards?((0,l.wg)(),(0,l.iD)("div",m,[(0,l._)("div",f,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.selectedCategories,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,d.C_)(["triangle",{triangle_last:!n.categories.length&&o.selectedCategories.length-1==t}]),disabled:!n.categories.length&&o.selectedCategories.length-1==t,key:e,onClick:t=>n.selectCategories(e)},(0,d.zw)(e?.name),11,w)))),128))]),o.showSpinner?((0,l.wg)(),(0,l.iD)("div",y,k)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l._)("div",C,[(0,l._)("div",L,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.categories,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"card",key:e,onClick:t=>n.selectCategories(e)},[(0,l._)("div",D,[W,(0,l._)("div",x,(0,d.zw)(e.name),1)]),q],8,P)))),128))])]),0!=n.products.length?((0,l.wg)(),(0,l.j4)(b,{key:0,class:"sls_paginator",page:n.page,onChangePage:n.changePage},null,8,["page","onChangePage"])):(0,l.kq)("",!0),(0,l._)("div",A,[0==n.products.length?((0,l.wg)(),(0,l.iD)("label",S," Ничего не найдено ")):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[o.useSkeletonCard?((0,l.wg)(!0),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(n.products,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"card skeleton",key:e},[_e,(0,l._)("div",he,[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(7,(e=>(0,l._)("div",{key:e,class:"sls_row"},me))),64))]),fe])))),128)):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(n.products,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"card",key:e},[(0,l._)("div",V,[T,(0,l._)("div",F,(0,d.zw)(e?.fields?.name),1)]),(0,l._)("div",z,[(0,l._)("div",I,[H,(0,l._)("div",Y,(0,d.zw)(e.is_service?"Услуга":"Товар"),1)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.sortedFields,(t=>((0,l.wg)(),(0,l.iD)(l.HY,{key:t},[11===t.type?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",j,[(0,l._)("div",O,(0,d.zw)(t.name)+" : ",1),(0,l._)("div",E,(0,d.zw)(e?.fields[t.code]?.cost?e?.fields[t.code]?.cost:(e?.fields[t.code]?.currency,e?.fields[t.code]?.currency)),1)]),e?.fields[t.code]?.is_nds?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",M,[B,(0,l._)("div",R,(0,d.zw)(e?.fields[t.code]?.nds),1)]),(0,l._)("div",N,[U,(0,l._)("div",Z,(0,d.zw)(e?.fields[t.code]?.is_price_include_nds?"Да":"Нет"),1)])],64)):(0,l.kq)("",!0)],64)):13===t.type?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l._)("div",K,[(0,l._)("div",G,(0,d.zw)(t.name)+": ",1),X]),(0,l._)("div",J,[Q,(0,l._)("div",ee,(0,d.zw)(-1==e?.fields?.free_4_reserve?"∞":Number(e?.fields?.free_4_reserve?e?.fields?.free_4_reserve:0)),1)])],64)):12===t.type?((0,l.wg)(),(0,l.iD)("div",te,[(0,l._)("div",se,(0,d.zw)(t.name)+": ",1),(0,l._)("div",ie,(0,d.zw)(n.categoriesForCard?.[e?.fields?.[t.code]]),1)])):"name"===t.code?((0,l.wg)(),(0,l.iD)(l.HY,{key:3},[],64)):15===t.type&&e?.fields[t.code]?.length?((0,l.wg)(),(0,l.iD)("div",le,[(0,l._)("div",ae,(0,d.zw)(t.name)+":",1),(0,l._)("div",oe,[(0,l.Wm)($,{imagesList:e?.fields[t.code],sizeWindow:"m",float:"right"},null,8,["imagesList"])])])):((0,l.wg)(),(0,l.iD)("div",de,[(0,l._)("div",ne,(0,d.zw)(t.name)+":",1),(0,l._)("div",re,(0,d.zw)(e?.fields[t.code]),1)]))],64)))),128))]),(0,l._)("div",ce,[e.is_service?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[o.allWhsList?.[t]?.length?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input",style:{"min-width":"70px"},"onUpdate:modelValue":e=>o.allWhsList[t][0].specialValue=e},null,8,ue)),[[i.nr,o.allWhsList[t][0].specialValue]]):(0,l.kq)("",!0)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[o.allWhsList?.[t]?.length?((0,l.wg)(),(0,l.j4)(g,{key:0,style:{"min-width":"70px",width:"100%"},list:o.allWhsList?.[t]?.filter((t=>(e.allow_add_with_zero_count||!(t.count<1))&&(!n.selectedWirePerLead.value||t.code==n.selectedWirePerLead.value))),special:!0,requestDelay:0,countLettersReq:0,allow_add_with_zero_count:e.allow_add_with_zero_count,one_wh_per_lead:e.one_wh_per_lead,placeholder:o.allWhsList?.[t]?.reduce(((e,t)=>e+Number(t?.specialValue)),0),onChangeInputValue:e=>o.inputValues[t]=e},null,8,["list","allow_add_with_zero_count","one_wh_per_lead","placeholder","onChangeInputValue"])):(0,l.kq)("",!0)],64)),(0,l._)("div",{class:(0,d.C_)(["sls_btn btn_green btn_del",{btn_del_disabled:!!n.disableAddToDeal||(e.is_service?!o.allWhsList[t][0]?.specialValue:0==o.allWhsList?.[t]?.reduce(((e,t)=>e+Number(t?.specialValue)),0))}]),onClick:()=>n.disableAddToDeal?null:(e.is_service?o.allWhsList[t][0]?.specialValue:0!=o.allWhsList?.[t]?.reduce(((e,t)=>e+Number(t?.specialValue)),0))?n.addToLead(e.id):null}," Добавить к сделке ",10,pe)])])))),128))],64))]),0!=n.products.length?((0,l.wg)(),(0,l.j4)(b,{key:1,class:"sls_paginator",page:n.page,onChangePage:n.changePage},null,8,["page","onChangePage"])):(0,l.kq)("",!0)],64))])):(0,l.kq)("",!0)])),_:1})]),we])],2),((0,l.wg)(),(0,l.j4)(l.lR,{to:"body"},[(0,l.Wm)(i.uT,{name:"rows"},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.j4)(l.Ob,null,[o.show_filters?((0,l.wg)(),(0,l.j4)(ge,{key:0,onClose:n.close_filters,onAccept:n.accept_filters},null,8,["onClose","onAccept"])):(0,l.kq)("",!0)],1024))])),_:1})]))],64)}var be=s(65);const ke=e=>((0,l.dD)("data-v-b4ef77ce"),e=e(),(0,l.Cn)(),e),Ce={class:"input-select"},Le=ke((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),Pe=[Le],De=["disabled","placeholder"],We={key:0,class:"list top",ref:"listRef"},xe=["onClick"],qe=["onUpdate:modelValue"],Ae={key:0,class:"placeholder"},Se=ke((()=>(0,l._)("div",null,[(0,l._)("div",{class:"title"}),(0,l._)("div",{class:"text"})],-1))),Ve=ke((()=>(0,l._)("div",{class:"aside"},null,-1))),Te=[Se,Ve];function Fe(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",Ce,[s.special?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,d.C_)(["title",{title_checked:a.showList}]),onClick:t[0]||(t[0]=e=>s.disabled?null:a.openList()),ref:"title"},[(0,l._)("p",null,(0,d.zw)(s.placeholder),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,d.C_)(["arrow",{rotate_arrow:a.showList}])},Pe,2))],2)):(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:1,type:"text",class:(0,d.C_)(["sls_input",{input_uderline:s.input_uderline,black_text:s.SelectedInTitle&&s.selected?.name}]),"onUpdate:modelValue":t[1]||(t[1]=e=>a.inputValue=e),onClick:t[2]||(t[2]=e=>a.openList()),disabled:s.disabled,placeholder:s.SelectedInTitle&&s.selected?.name?s.selected?.name:s.placeholder,ref:"title"},null,10,De)),[[i.nr,a.inputValue]]),a.showList?((0,l.wg)(),(0,l.iD)(l.HY,{key:2},[(0,l._)("div",{class:"backdrop",onClick:t[3]||(t[3]=e=>a.closeList())}),(0,l.Wm)(i.W3,{name:"list"},{default:(0,l.w5)((()=>[s.list.length?((0,l.wg)(),(0,l.iD)("ul",We,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.list,(e=>((0,l.wg)(),(0,l.iD)("li",{class:(0,d.C_)(["item",{selected:e.value===s.selected?.value}]),key:e.value,onClick:t=>a.selectItem(e)},[s.special?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input","onUpdate:modelValue":t=>e.specialValue=t,style:{width:"100px","min-width":"1%"},placeholder:"введите кол-во",onClick:t[4]||(t[4]=(0,i.iM)((()=>{}),["stop"]))},null,8,qe)),[[i.nr,e.specialValue]]):(0,l.kq)("",!0),(0,l.Uk)(" "+(0,d.zw)(e.name),1)],10,xe)))),128))],512)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[a.showPlaceholder?((0,l.wg)(),(0,l.iD)("div",Ae,[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(4,(e=>(0,l._)("div",{class:"item",key:e},Te))),64))])):(0,l.kq)("",!0)],64))])),_:1})],64)):(0,l.kq)("",!0)])}var ze=s(870),Ie=s(466);const $e={props:{list:Array,selected:{type:Object,required:!1},countLettersReq:{type:Number,required:!1,default:()=>0},requestDelay:{type:Number,required:!1,default:()=>300},placeholder:{type:String,required:!1},input_uderline:{type:Boolean,required:!1,default:()=>!1},SelectedInTitle:{type:Boolean,required:!1,default:()=>!1},special:{type:Boolean,required:!1,default:()=>!1},disabled:{type:Boolean,required:!1,default:()=>!1},allow_add_with_zero_count:{type:Boolean,required:!1,default:()=>!1},one_wh_per_lead:{type:Boolean,required:!1,default:()=>!1}},emits:["changeInputValue","focusIn","select"],setup(e,t){const s=(0,ze.iH)(""),i=(0,ze.iH)(null),a=(0,ze.iH)(!1),o=()=>{a.value=!1,clearTimeout(i.value),s.value.length>=e.countLettersReq&&(a.value=!0,i.value=setTimeout((()=>{t.emit("changeInputValue",s.value),setTimeout((()=>a.value=!1),3*e.requestDelay)}),e.requestDelay))};(0,l.YP)(s,(()=>o()));const d=(0,ze.iH)(!1),n=()=>d.value=!1,r=()=>(d.value=!0,c(),o()),c=()=>t.emit("focusIn"),u=e=>{t.emit("select",e),n(),s.value=""};e.special&&(0,l.YP)(e.list,(()=>{e.list.map((t=>{t.specialValue>t.count&&!e.allow_add_with_zero_count&&(t.specialValue=t.count),t.specialValue<0&&(t.specialValue=0)}))}),{deep:!0}),(0,l.YP)(d,(()=>{(0,l.Y3)((()=>p()))}));const p=()=>{const e=_.value?.getBoundingClientRect();m.value=window.innerHeight-e?.bottom+e?.height+6+"px",h.value=e?.width-2+"px",g.value=e?.x+"px",v.value=e?.bottom+6+"px",f.value&&(window.innerHeight-e?.bottom+e?.height+2<400?f.value.classList.contains("top")&&(f.value.classList.add("bottom"),f.value.classList.remove("top")):f.value.classList.contains("bottom")&&(f.value.classList.remove("bottom"),f.value.classList.add("top")))},_=(0,ze.iH)(null),h=(0,ze.iH)(null),g=(0,ze.iH)(null),v=(0,ze.iH)(null),m=(0,ze.iH)(null),f=(0,ze.iH)(null),w=(0,Ie.CDf)(_);return(0,l.YP)(w,(()=>{w.value?window.addEventListener("scroll",p):window.removeEventListener("scroll",p)})),{inputValue:s,showList:d,closeList:n,openList:r,selectItem:u,showPlaceholder:a,title:_,optionsWidth:h,optionsX:g,optionsY:v,optionsBottom:m,listRef:f,titleIsVisible:w}}},He=()=>{(0,i.sj)((e=>({"76f16334":e.optionsY,c20a0f44:e.optionsBottom,"79e2bd33":e.optionsWidth,"76f16336":e.optionsX})))},Ye=$e.setup;$e.setup=Ye?(e,t)=>(He(),Ye(e,t)):He;var je=$e,Oe=s(89);const Ee=(0,Oe.Z)(je,[["render",Fe],["__scopeId","data-v-b4ef77ce"]]);var Me=Ee;const Be={class:"sls_grid"},Re={class:"current d sls_pag_btn"};function Ne(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("div",Be,[s.page.current!=s.page.first&&null!=s.page.prev?((0,l.wg)(),(0,l.iD)("div",{key:0,onClick:t[0]||(t[0]=e=>i.prev()),class:"a sls_pag_btn"},(0,d.zw)("<"))):(0,l.kq)("",!0),s.page.current!=s.page.first&&s.page.prev!=s.page.first?((0,l.wg)(),(0,l.iD)("div",{key:1,onClick:t[1]||(t[1]=e=>i.first()),class:"b sls_pag_btn"},(0,d.zw)(s.page.first),1)):(0,l.kq)("",!0),s.page.current!=s.page.first&&null!=s.page.prev?((0,l.wg)(),(0,l.iD)("div",{key:2,onClick:t[2]||(t[2]=e=>i.prev()),class:"c sls_pag_btn"},(0,d.zw)(s.page.prev),1)):(0,l.kq)("",!0),(0,l._)("div",Re,(0,d.zw)(s.page.current),1),s.page.current!=s.page.last&&null!=s.page.next?((0,l.wg)(),(0,l.iD)("div",{key:3,onClick:t[3]||(t[3]=e=>i.next()),class:"e sls_pag_btn"},(0,d.zw)(s.page.next),1)):(0,l.kq)("",!0),s.page.current!=s.page.last&&s.page.next!=s.page.last?((0,l.wg)(),(0,l.iD)("div",{key:4,onClick:t[4]||(t[4]=e=>i.last()),class:"f sls_pag_btn"},(0,d.zw)(s.page.last),1)):(0,l.kq)("",!0),s.page.current!=s.page.last&&null!=s.page.next?((0,l.wg)(),(0,l.iD)("div",{key:5,onClick:t[5]||(t[5]=e=>i.next()),class:"g sls_pag_btn"},(0,d.zw)(">"))):(0,l.kq)("",!0)])}var Ue={props:{page:Object},emits:{changePage(e){return e>0&&"number"===typeof e}},setup(e,t){const s=()=>t.emit("changePage",e.page.first),i=()=>t.emit("changePage",e.page.current-1),l=()=>t.emit("changePage",e.page.current+1),a=()=>t.emit("changePage",e.page.last);return{prev:i,first:s,next:l,last:a}}};const Ze=(0,Oe.Z)(Ue,[["render",Ne],["__scopeId","data-v-2ab60581"]]);var Ke=Ze;const Ge=e=>((0,l.dD)("data-v-47b557c8"),e=e(),(0,l.Cn)(),e),Xe={class:"app_modal"},Je={class:"sls_container"},Qe={class:"sls_header"},et={class:"saved"},tt=["onClick"],st=Ge((()=>(0,l._)("path",{fill:"red",d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12M8 9h8v10H8V9m7.5-5l-1-1h-5l-1 1H5v2h14V4h-3.5Z"},null,-1))),it=[st],lt=Ge((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 15 15"},[(0,l._)("path",{fill:"currentColor","fill-rule":"evenodd",d:"M11.782 4.032a.575.575 0 1 0-.813-.814L7.5 6.687L4.032 3.218a.575.575 0 0 0-.814.814L6.687 7.5l-3.469 3.468a.575.575 0 0 0 .814.814L7.5 8.313l3.469 3.469a.575.575 0 0 0 .813-.814L8.313 7.5l3.469-3.468Z","clip-rule":"evenodd"})],-1))),at=[lt],ot={class:"sls_content"};function dt(e,t,s,i,a,o){const n=(0,l.up)("main-grid");return(0,l.wg)(),(0,l.iD)("div",Xe,[(0,l._)("div",{class:"sls_backdrop_with_filter",onClick:t[0]||(t[0]=e=>i.close())}),(0,l._)("div",Je,[(0,l._)("div",Qe,[(0,l._)("div",et,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.savedAllWhsList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{key:e,class:"item"},[(0,l.Uk)((0,d.zw)(e[0].product_name)+" : "+(0,d.zw)(e.reduce(((e,t)=>e+Number(t.specialValue)),0))+" ",1),((0,l.wg)(),(0,l.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",onClick:e=>i.deleteSavedAllWhsList(t)},it,8,tt))])))),128))]),i.savedAllWhsList.length?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"sls_btn btn2",onClick:t[1]||(t[1]=e=>i.accepMainGridRef())}," Добавить к сделке ")):(0,l.kq)("",!0),(0,l._)("button",{class:"exit",onClick:t[2]||(t[2]=e=>i.close())},at)]),(0,l._)("div",ot,[((0,l.wg)(),(0,l.j4)(l.Ob,null,[(0,l.Wm)(n,{onChangeSavedAllWhsList:i.changeSavedAllWhsList,onAccept:i.accept,class:"main_grid",ref:"mainGridRef"},null,8,["onChangeSavedAllWhsList","onAccept"])],1024))])])])}const nt=e=>((0,l.dD)("data-v-d1f643ea"),e=e(),(0,l.Cn)(),e),rt={key:0,class:"wrapper"},ct={class:"main"},ut={class:"table",ref:"table"},pt={key:0,class:"spinner"},_t=nt((()=>(0,l._)("img",{src:"https://warehouse2.salesup.pro/images/spinner.gif",alt:"spinner"},null,-1))),ht=[_t],gt={key:0},vt={class:"item"},mt={key:0},ft=["onUpdate:modelValue"],wt={key:1},yt={key:0,class:"item"},bt={key:1,class:"item"},kt={key:0},Ct={key:1},Lt={key:0,class:"text"},Pt={class:"right"};function Dt(e,t,s,a,o,n){const r=(0,l.up)("TableSettings"),c=(0,l.up)("MainGridFilters"),u=(0,l.up)("main-grid-bar"),p=(0,l.up)("AppInputSelect"),_=(0,l.up)("AppImagesCarusel"),h=(0,l.up)("grid-bottom");return(0,l.wg)(),(0,l.iD)(l.HY,null,[((0,l.wg)(),(0,l.j4)(l.lR,{to:"body"},[(0,l.Wm)(i.uT,{name:"modal"},{default:(0,l.w5)((()=>[n.showTableSettings?((0,l.wg)(),(0,l.j4)(r,{key:0,onClose:n.closeTableSettings},null,8,["onClose"])):(0,l.kq)("",!0)])),_:1})])),o.isLoading?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",rt,[n.all_fields.length&&n.tableConfig!={}&&n.sortedFields.length?((0,l.wg)(),(0,l.j4)(c,{key:0,ref:"filters",fields:n.all_fields,tableConfig:n.tableConfig,sortedFields:n.sortedFields,onConfirm:t[0]||(t[0]=()=>n.get_products(n.productsParams))},null,8,["fields","tableConfig","sortedFields"])):(0,l.kq)("",!0),(0,l._)("div",ct,[(0,l._)("table",ut,[(0,l._)("thead",null,[(0,l.Wm)(u,{ref:"bar",fields:n.all_fields,onSort:n.sort,tableConfig:n.tableConfig,sortedFields:n.sortedFields,class:"main-grid-bar"},null,8,["fields","onSort","tableConfig","sortedFields"])]),o.showSpinner?((0,l.wg)(),(0,l.iD)("div",pt,ht)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[n.products.length?((0,l.wg)(),(0,l.iD)("tbody",gt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.products,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",vt,[e.is_service?((0,l.wg)(),(0,l.iD)("div",mt,[o.allWhsList?.[t]?.length?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input",style:{"min-width":"70px"},"onUpdate:modelValue":e=>o.allWhsList[t][0].specialValue=e},null,8,ft)),[[i.nr,o.allWhsList[t][0].specialValue]]):(0,l.kq)("",!0)])):((0,l.wg)(),(0,l.iD)("div",wt,[(0,l.Wm)(p,{style:{"min-width":"70px"},list:o.allWhsList?.[t]?.filter((t=>(e.allow_add_with_zero_count||!(t?.count<1))&&(!n.selectedWirePerLead.value||t.code==n.selectedWirePerLead.value))),special:!0,requestDelay:0,countLettersReq:0,allow_add_with_zero_count:e.allow_add_with_zero_count,one_wh_per_lead:e.one_wh_per_lead,placeholder:o.allWhsList?.[t]?.reduce(((e,t)=>e+Number(t?.specialValue)),0),onChangeInputValue:e=>o.inputValues[t]=e},null,8,["list","allow_add_with_zero_count","one_wh_per_lead","placeholder","onChangeInputValue"])]))]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.sortedFields,(t=>((0,l.wg)(),(0,l.iD)(l.HY,{key:t},[15===t[1].type?((0,l.wg)(),(0,l.iD)("td",yt,[(0,l.Wm)(_,{imagesList:e.fields[t[0]]},null,8,["imagesList"])])):((0,l.wg)(),(0,l.iD)("td",bt,[t[0].split(".").length<2?((0,l.wg)(),(0,l.iD)("span",kt,(0,d.zw)("category"==t[0]?n.categories?.[e.fields?.[t?.[0]]]:9==t?.[1]?.type?e.fields?.[t[0]]?"Да":"Нет":"cost_price"==t[0]?e.fields?.[t[0]]?Math.round(100*e.fields?.[t[0]])/100:"0":e.fields?.[t[0]]),1)):((0,l.wg)(),(0,l.iD)("span",Ct,(0,d.zw)("cost"==t[0].split(".")[1]?void 0==e.fields?.[t[0].split(".")[0]]?.[t[0]?.split(".")?.[1]]?"0":e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]+" "+(void 0==e.fields?.[t[0]?.split(".")?.[0]]?.currency||null==e.fields?.[t[0]?.split(".")?.[0]]?.currency?"":e.fields?.[t[0]?.split(".")?.[0]]?.currency):9==t[1].type?e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]?"Да":"Нет":e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]),1))]))],64)))),128))])))),128))])):(0,l.kq)("",!0)],64))],512),0==n.products.length?((0,l.wg)(),(0,l.iD)("label",Lt," Ничего не найдено ")):(0,l.kq)("",!0)]),(0,l._)("div",Pt,[(0,l.Wm)(h,{page:n.page,blur:e.show_edit_modal,show:0!=n.products.length,count:n.count,onChangePage:n.changePage,onChangeCount:n.changeCount},null,8,["page","blur","show","count","onChangePage","onChangeCount"])])]))],64)}const Wt=e=>((0,l.dD)("data-v-7189fe64"),e=e(),(0,l.Cn)(),e),xt={class:"modal"},qt={class:"wrapper"},At=Wt((()=>(0,l._)("div",{class:"sls_modal-header"},[(0,l._)("div",{class:"head-text"},"Настройка таблицы")],-1))),St={class:"sls_modal-body"},Vt=Wt((()=>(0,l._)("div",{class:"text"},[(0,l._)("small",{class:"small-text"},"Перетаскивайте колонки для изменения очередности")],-1))),Tt=["onUpdate:modelValue","id","disabled"],Ft=["for"],zt={class:"sls_modal-footer"};function It(e,t,s,a,o,n){const r=(0,l.up)("draggable"),c=(0,l.up)("btns-save-close");return(0,l.wg)(),(0,l.iD)("div",xt,[(0,l._)("div",{class:"backdrop_with_filter sls_backdrop_with_filter",onClick:t[0]||(t[0]=e=>n.close())}),(0,l._)("div",qt,[At,(0,l._)("div",St,[Vt,(0,l.Wm)(r,{class:"dragArea",list:o.list,onChange:e.changeData},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.list,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"item",key:e},[(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":t=>e.visible=t,id:e.code,class:"checkbox",disabled:2===e.visible||-1===e.visible},null,8,Tt),[[i.e8,e.visible]]),(0,l._)("label",{for:e.code},null,8,Ft),(0,l.Uk)(" "+(0,d.zw)(e.name),1)])))),128))])),_:1},8,["list","onChange"])]),(0,l._)("div",zt,[(0,l.Wm)(c,{onClose:n.close,onSave:n.save},null,8,["onClose","onSave"])])])])}const $t={class:"sls_btns"},Ht=["disabled"];function Yt(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("div",$t,[s.show_close?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"sls_btn btn_grey",onClick:t[0]||(t[0]=e=>o.close())},[(0,l.WI)(e.$slots,"close",{},(()=>[(0,l.Uk)("Отмена")]),!0)])):(0,l.kq)("",!0),(0,l.WI)(e.$slots,"other_btns",{},void 0,!0),s.show_save?((0,l.wg)(),(0,l.iD)("button",{key:1,class:"sls_btn btn_blue",onClick:t[1]||(t[1]=e=>o.save()),disabled:s.disabledSave},[(0,l.WI)(e.$slots,"save",{},(()=>[(0,l.Uk)("Сохранить")]),!0)],8,Ht)):(0,l.kq)("",!0)])}var jt={props:{show_close:{type:Boolean,required:!1,default(){return!0}},show_save:{type:Boolean,required:!1,default(){return!0}},disabledSave:{type:Boolean,required:!1,default(){return!1}}},emits:{close:null,save:null},methods:{close(){this.$emit("close")},save(){this.$emit("save")}}};const Ot=(0,Oe.Z)(jt,[["render",Yt],["__scopeId","data-v-eb47f442"]]);var Et=Ot,Mt=s(249),Bt={components:{draggable:Mt.J,BtnsSaveClose:Et},props:{},emits:{},data(){return{list:[]}},computed:{tableConfig(){return this.$store.state.fields.tableConfig}},async mounted(){await this.$store.dispatch("getTableConfig",{account_id:30214471,code:"widget"});const e=[];Object.entries(this.tableConfig).map((t=>{t[1].code=t[0],e.push(t[1])})),this.list=JSON.parse(JSON.stringify(e)),this.list.map((e=>{1===e.visible&&(e.visible=!0),0===e.visible&&(e.visible=!1)}))},methods:{async save(){this.list.map(((e,t)=>e.sort=t+1));const e={config:[],code:"widget",account_id:30214471};this.list.forEach((t=>{t.visible&&e.config.push(t.code)})),await this.$store.dispatch("updateTableConfig",e),this.close()},close(){this.$emit("close"),this.$store.commit("toggleShowTableSettings",!1)}}};const Rt=(0,Oe.Z)(Bt,[["render",It],["__scopeId","data-v-7189fe64"]]);var Nt=Rt;const Ut=e=>((0,l.dD)("data-v-0ba4caaf"),e=e(),(0,l.Cn)(),e),Zt={class:"wrapper"},Kt={class:"filters"},Gt={class:"item"},Xt={key:0,class:"item"},Jt={class:"title"},Qt=["onClick"],es=Ut((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 15 15"},[(0,l._)("path",{fill:"currentColor","fill-rule":"evenodd",d:"M11.782 4.032a.575.575 0 1 0-.813-.814L7.5 6.687L4.032 3.218a.575.575 0 0 0-.814.814L6.687 7.5l-3.469 3.468a.575.575 0 0 0 .814.814L7.5 8.313l3.469 3.469a.575.575 0 0 0 .813-.814L8.313 7.5l3.469-3.468Z","clip-rule":"evenodd"})],-1))),ts=[es],ss={class:"accept_btn"};function is(e,t,s,i,a,o){const n=(0,l.up)("selector-vue"),r=(0,l.up)("filter-number"),c=(0,l.up)("filter-text"),u=(0,l.up)("filter-list"),p=(0,l.up)("filter-date"),_=(0,l.up)("filter-flag");return(0,l.wg)(),(0,l.iD)("div",Zt,[(0,l._)("div",Kt,[(0,l._)("div",Gt,[(0,l.Wm)(n,{options_props:o.filteredFiltersValue,selected_option:{name:"Добавить фильтр",value:-1},onSelect:o.add_filter},null,8,["options_props","onSelect"])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.filtersValue,((e,t)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:t},[e.selected?((0,l.wg)(),(0,l.iD)("div",Xt,[(0,l._)("div",Jt,(0,d.zw)(e.name),1),1==e.type||2==e.type?((0,l.wg)(),(0,l.j4)(r,{key:0,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),3==e.type||4==e.type?((0,l.wg)(),(0,l.j4)(c,{key:1,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),5==e.type||6==e.type?((0,l.wg)(),(0,l.j4)(u,{key:2,item:e,idx:t,selector_options:e.selector_options,onChange_filter_value:o.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,l.kq)("",!0),12==e.type?((0,l.wg)(),(0,l.j4)(u,{key:3,item:e,idx:t,selector_options:a.categories_options,onChange_filter_value:o.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,l.kq)("",!0),7==e.type||8==e.type?((0,l.wg)(),(0,l.j4)(p,{key:4,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),9==e.type?((0,l.wg)(),(0,l.j4)(_,{key:5,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),(0,l._)("button",{class:"sls_remove",onClick:t=>o.remove_filter(e)},ts,8,Qt)])):(0,l.kq)("",!0)],64)))),128))]),(0,l._)("div",ss,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>o.confirmFilters()),class:"btn2 sls_btn"},"Применить"),(0,l._)("button",{onClick:t[1]||(t[1]=e=>o.clearFilters()),class:"btn1 sls_btn"},"Очистить")])])}const ls={class:"filter"};function as(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",ls,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>4==o.option?o.option=0:o.option+=1)},[(0,l._)("span",{class:(0,d.C_)({big:0==o.option})},(0,d.zw)(o.options[o.option]),3)]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.filterValue=e),type:"number"},null,512),[[i.nr,o.filterValue]])])}var os={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{option:0,filterValue:null,options:["=",">",">=","<","<="]}},computed:{option_value(){return{option:this.options[this.option],value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=this.item.value,null==this.item.value&&(this.option=0)}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)}}};const ds=(0,Oe.Z)(os,[["render",as],["__scopeId","data-v-f983fcf0"]]);var ns=ds;const rs={class:"filter"};function cs(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",rs,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>1==o.option?o.option=0:o.option+=1)},[(0,l._)("span",null,(0,d.zw)(o.options[o.option]),1)]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.filterValue=e),type:"text"},null,512),[[i.nr,o.filterValue]])])}var us={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{option:0,filterValue:null,options:["=","~"]}},computed:{option_value(){return{option:this.options[this.option],value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=this.item.value,null==this.item.value&&(this.option=0)}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)}}};const ps=(0,Oe.Z)(us,[["render",cs],["__scopeId","data-v-3df224a4"]]);var _s=ps;const hs=e=>((0,l.dD)("data-v-4b2b609a"),e=e(),(0,l.Cn)(),e),gs={class:"filter"},vs=hs((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),ms=[vs];function fs(e,t,s,i,a,o){const n=(0,l.up)("multi-selector");return(0,l.wg)(),(0,l.iD)("div",gs,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>o.open_selector())},[(0,l._)("div",{class:(0,d.C_)(["arrow",{rotate_arrow:a.show_selector}])},ms,2)]),a.show_selector?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",{class:"backdrop",onClick:t[1]||(t[1]=e=>o.closeSelector())}),(0,l.Wm)(n,{class:"selector",id:"selector123",options_props:[{name:"Все",value:""},...s.selector_options],onSelect:o.option_select_multi,selected_options:a.filterValue,tabindex:"1"},null,8,["options_props","onSelect","selected_options"])],64)):(0,l.kq)("",!0)])}const ws={class:"multi_selector"},ys=["onClick"];function bs(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("div",ws,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.options_props,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,d.C_)(["item",{selected:s.selected_options[t],disabled:s.disabled}]),key:e.value,onClick:e=>i.select(t)},(0,d.zw)(e.name),11,ys)))),128))])}var ks={name:"MultiSelector",props:{options_props:{type:Array,required:!0,default(){return[]}},selected_options:{type:Array,required:!0,default(){return[!0]}},disabled:{type:Boolean,required:!1,default(){return!1}}},emits:{select:null},setup(e,{emit:t}){const s=(0,ze.iH)([]);(0,l.bv)((()=>s.value=[...e.selected_options])),(0,l.YP)((()=>e.selected_options),(()=>{s.value=[...e.selected_options]}),{deep:!0});const i=i=>{e.disabled||(0==i&&(s.value=[]),1==s.value[0]&&(s.value[0]=!1),s.value[i]=!s.value[i],s.value.includes(!0)||(s.value[0]=!0),t("select",s.value))};return{options_value:s,select:i}}};const Cs=(0,Oe.Z)(ks,[["render",bs],["__scopeId","data-v-46865b2c"]]);var Ls=Cs,Ps={components:{MultiSelector:Ls},props:{item:{type:Object,required:!0},idx:{type:Number,required:!0},selector_options:{type:Array,required:!0}},data(){return{filterValue:[],show_selector:!1}},computed:{option_value(){return{value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=[!1],this.item.value.forEach(((e,t)=>{this.filterValue[t+1]=e}))}))},emit_value(){const e={value:[]},t=[{name:"Все",value:""},...this.selector_options];this.option_value.value.forEach(((s,i)=>s?12==this.item.type?e.value.push(t[i]?.value):e.value.push(t[i]?.name):null)),this.$emit("change_filter_value",e,this.idx)},option_select_multi(e){this.filterValue=e},open_selector(){this.show_selector=!0,(0,l.Y3)((()=>{this.show_selector&&document.getElementById("selector123").focus()}))},handleFocusOut(){setTimeout((()=>{(0,l.Y3)((()=>{this.show_selector=!1}))}),150)},closeSelector(){this.show_selector=!1}}};const Ds=(0,Oe.Z)(Ps,[["render",fs],["__scopeId","data-v-4b2b609a"]]);var Ws=Ds;const xs={key:0,class:"filter"},qs={key:1,class:"filter"};function As(e,t,s,a,o,d){return(0,l.wg)(),(0,l.iD)(l.HY,null,[7==s.item.type?((0,l.wg)(),(0,l.iD)("div",xs,[(0,l.wy)((0,l._)("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=e=>a.date_start=e)},null,512),[[i.nr,a.date_start]]),(0,l.wy)((0,l._)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>a.date_end=e)},null,512),[[i.nr,a.date_end]])])):(0,l.kq)("",!0),8==s.item.type?((0,l.wg)(),(0,l.iD)("div",qs,[(0,l.wy)((0,l._)("input",{type:"datetime-local","onUpdate:modelValue":t[2]||(t[2]=e=>a.date_start=e)},null,512),[[i.nr,a.date_start]]),(0,l.wy)((0,l._)("input",{type:"datetime-local","onUpdate:modelValue":t[3]||(t[3]=e=>a.date_end=e)},null,512),[[i.nr,a.date_end]])])):(0,l.kq)("",!0)],64)}var Ss={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},emits:{change_filter_value:null},setup(e,{emit:t}){const s=(0,ze.iH)(""),i=(0,ze.iH)(""),a=(0,l.Fl)((()=>({value:`${s.value}~${i.value}`})));function o(){t("change_filter_value",a.value,e.idx)}function d(){if(e.item.value){const[t,l]=e.item.value.split("~");s.value=t,i.value=l}else s.value="",i.value=""}return(0,l.bv)((()=>{(0,l.Y3)((()=>{d()}))})),(0,l.YP)((()=>e.item.value),(()=>{d()})),(0,l.YP)(a,(()=>o())),{date_start:s,date_end:i,emit_value:o}}};const Vs=(0,Oe.Z)(Ss,[["render",As],["__scopeId","data-v-d5da7a74"]]);var Ts=Vs;const Fs={class:"filter"};function zs(e,t,s,i,a,o){const d=(0,l.up)("selector-vue");return(0,l.wg)(),(0,l.iD)("div",Fs,[(0,l.Wm)(d,{options_props:i.options,onSelect:i.option_select,selected_option:i.options[i.filterValue-1]},null,8,["options_props","onSelect","selected_option"])])}const Is=e=>((0,l.dD)("data-v-7da80cea"),e=e(),(0,l.Cn)(),e),$s={class:"v-select"},Hs=Is((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),Ys=[Hs],js={class:"options",key:"a1"},Os=["onClick"],Es={key:0,class:"material-icons-outlined opacity-50"};function Ms(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",$s,[(0,l._)("div",{class:(0,d.C_)(["title",{title_checked:a.show_options,disabled:s.disabled}]),onClick:t[0]||(t[0]=e=>a.open_close_options()),onFocusout:t[1]||(t[1]=(...e)=>a.handleFocusOut&&a.handleFocusOut(...e)),tabindex:"0"},[(0,l._)("p",null,(0,d.zw)(s.selected_option.name),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,d.C_)(["arrow",{rotate_arrow:a.show_options}])},Ys,2))],34),(0,l.Wm)(i.uT,{name:"list"},{default:(0,l.w5)((()=>[a.show_options?((0,l.wg)(),(0,l.iD)("div",js,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.options,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.value,class:(0,d.C_)({optgroup:"optgroup"===e.value,selected:e.value==s.selected_option.value}),style:(0,d.j5)({backgroundColor:e.color}),onClick:t=>a.select_option(e)},[e.value==s.selected_option.value&&e.color?((0,l.wg)(),(0,l.iD)("span",Es," check ")):(0,l.kq)("",!0),e.optgroup?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Uk)("     "+(0,d.zw)(e.name),1)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:2},[(0,l.Uk)((0,d.zw)(e.name),1)],64))],14,Os)))),128))])):(0,l.kq)("",!0)])),_:1})])}var Bs={props:{options_props:{type:Array,default(){return[]},required:!0},selected_option:{type:Object,required:!0,default(){return{}}},disabled:{type:Boolean,required:!1,default:!1},idx:{type:Number,required:!1}},emits:{select:null},setup(e,{emit:t}){const s=(0,ze.iH)([]);(0,l.bv)((()=>{(0,l.Y3)((()=>{i()}))}));const i=()=>{s.value=[],e.options_props?.forEach((e=>s.value.push(e)))};(0,l.YP)((()=>e.options_props),(()=>{i()}),{deep:!0});const a=(0,ze.iH)(!1),o=()=>{a.value=!1},d=()=>{e.disabled||(a.value=!a.value)},n=()=>{o()},r=s=>{"optgroup"!=s.value&&(t("select",s,e.idx),o())};return{open_close_options:d,handleFocusOut:n,show_options:a,options:s,select_option:r}}};const Rs=(0,Oe.Z)(Bs,[["render",Ms],["__scopeId","data-v-7da80cea"]]);var Ns=Rs,Us={components:{SelectorVue:Ns},props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},setup(e,{emit:t}){const s=(0,ze.iH)([{name:"Все",value:1},{name:"Да",value:2},{name:"Нет",value:3}]),i=(0,ze.iH)(1),a=(0,l.Fl)((()=>({value:i.value})));(0,l.YP)(a,(()=>{t("change_filter_value",a.value,e.idx)}),{deep:!0});const o=()=>{(0,l.Y3)((()=>{i.value=e.item.value}))},d=e=>{i.value=e.value};return(0,l.YP)((()=>e.item),o),o(),{options:s,filterValue:i,option_value:a,option_select:d}}};const Zs=(0,Oe.Z)(Us,[["render",zs],["__scopeId","data-v-153ffddf"]]);var Ks=Zs,Gs={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},components:{FilterNumber:ns,FilterText:_s,FilterList:Ws,FilterDate:Ts,FilterFlag:Ks,SelectorVue:Ns},data(){return{filtersValue:[],categories_options:[],isConfirmFilters:!1,filter:{}}},computed:{productsParams(){return this.$store.state.products.productsParams},filteredFiltersValue(){return this.filtersValue.filter((e=>!e.selected))}},async mounted(){Promise.all([this.$store.dispatch("get_fields_properties",{account_id:30214471}),this.$store.dispatch("get_fields_properties2",{account_id:30214471})]),this.get_categories_options(),this.feelFilters()},watch:{sortedFields:{handler:function(){this.feelFilters()},deep:!0}},methods:{add_filter(e){e.selected=!0},remove_filter(e){e.selected=!1;let t=null;5!=e.type&&6!=e.type||(t=[]),9==e.type&&(t=1),12==e.type&&(t=[]),e.value=t,this.confirmFilters()},searchTitle(e){let t="";const[s,i]=e.split(".");return t=this.fields.find((e=>e.code===s))?.name,"count"===i&&(t+=": на складе"),"reserve"===i&&(t+=": в резерве"),"is_nds"===i&&(t+=": с НДС"),"is_price_include_nds"===i&&(t+=": НДС включен в цену"),"nds"===i&&(t+=": НДС %"),t},clearFilters(){this.feelFilters(),this.confirmFilters()},confirmFilters(){this.isConfirmFilters=!0;const e={};this.filtersValue.filter((e=>null!=e.value&&""!==e.value&&e.selected)).forEach((t=>{if(1!=t.type&&2!=t.type||(e[t.code]={compare:t.option,query:t.value}),3!=t.type&&4!=t.type||(e[t.code]={compare:t.option,query:t.value}),5!=t.type&&6!=t.type&&12!=t.type||t.value?.length&&(e[t.code]={compare:"in",query:t.value}),7==t.type){const s=t.value.split("~");s.forEach(((e,t)=>s[t]=e.split("-").join("."))),e[t.code]={from:s[0],to:s[1]}}if(8==t.type){const s=t.value.split("~");s.forEach(((e,t)=>{const i=e.split("T");i[0]=i[0].split("-").join("."),s[t]=i.join(" ")})),e[t.code]={from:s[0],to:s[1]}}})),this.filter=e,this.$store.commit("updateProductsParams",{filter:e,page:1}),this.$emit("confirm")},change_filter_value(e,t){Object.assign(this.filtersValue[t],e)},setFalseIsConfirmFilters(){this.isConfirmFilters=!1},setTrueIsConfirmFilters(){this.isConfirmFilters=!0},feelFilters(){this.filtersValue=[];const e=[];this.sortedFields.forEach((t=>{let s={};s={...this.fields.filter((e=>e.code.split(".")[0]==t[0].split(".")[0]))[0]},s.type=t[1].type,s.code=t[0],e.push(s)})),e.forEach((e=>{const t=e=>{const t=[];return null!=e&&e.forEach(((e,s)=>t.push({name:e,value:s}))),t};let s=null;5!=e.type&&6!=e.type||(s=[]),9==e.type&&(s=1),12==e.type&&(s=[]);const i={type:e.type,code:e.code,option:"=",selector_options:t(e.data),value:s,table_config:e.table_config,selected:!1,name:this.searchTitle(e.code)};this.filtersValue.push(i)}));const t={type:9,code:"isAvailable",option:"=",selector_options:[],value:1,table_config:{filtered:1,sort:2,sortable:1,visible:1},selected:!1,name:"Есть в наличии"};this.filtersValue.push(t)},get_categories_options(){this.$store.state.categories.fields_properties2.forEach((e=>{let t="";for(let s=1;s<e.level;s++)t+="-    ";this.categories_options.push({name:t+e.name,value:e.id})}))}}};const Xs=(0,Oe.Z)(Gs,[["render",is],["__scopeId","data-v-0ba4caaf"]]);var Js=Xs;const Qs=e=>((0,l.dD)("data-v-5e8633ea"),e=e(),(0,l.Cn)(),e),ei={class:"bar_row"},ti={class:"bar_item item"},si=Qs((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 512 512"},[(0,l._)("path",{fill:"#757575",d:"M495.9 166.6c3.2 8.7.5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4l-55.6 17.8c-8.8 2.8-18.6.3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4c-1.1-8.4-1.7-16.9-1.7-25.5s.6-17.1 1.7-25.4l-43.3-39.4c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160a80 80 0 1 0 0 160z"})],-1))),ii=[si],li=["onClick"],ai={class:"bar_item_group"},oi={key:0,class:"bar_item_icon"},di={key:0,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},ni=Qs((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v14m4-10l-4-4M8 9l4-4"},null,-1))),ri=[ni],ci={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},ui=Qs((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v14m4-4l-4 4m-4-4l4 4"},null,-1))),pi=[ui],_i={key:2,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},hi=Qs((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m11 16l-3 3m0 0l-3-3m3 3V5m5 3l3-3m0 0l3 3m-3-3v14"},null,-1))),gi=[hi];function vi(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("tr",ei,[(0,l._)("th",ti,[(0,l._)("div",{onClick:t[0]||(t[0]=e=>o.openTableSettings()),class:"tableSettings"},ii)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.sortedFields,((e,t)=>((0,l.wg)(),(0,l.iD)("th",{class:"bar_item item",style:(0,d.j5)({minWidth:0!=o.width[t]?o.width[t]+"px":(o.collsCount>=8||o.collsCount,100/o.collsCount+"%")}),onClick:t=>e[1].sortable&&9!=e[1].type?o.sort(e[0]):null,key:e},[(0,l._)("div",ai,[(0,l._)("label",null,(0,d.zw)(e[1].name),1),e[1].sortable&&9!=e[1].type?((0,l.wg)(),(0,l.iD)("button",oi,[a.order.code===e[0]&&"desc"===a.order.prev_order?((0,l.wg)(),(0,l.iD)("svg",di,ri)):a.order.code===e[0]&&"asc"===a.order.prev_order?((0,l.wg)(),(0,l.iD)("svg",ci,pi)):((0,l.wg)(),(0,l.iD)("svg",_i,gi))])):(0,l.kq)("",!0)])],12,li)))),128))])}var mi={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},data(){return{order:{code:"",prev_order:""},disableExportXlsx:!1,allSelectedProducts:!1}},computed:{...(0,be.Se)(["fields"]),collsCount(){return this.tableConfig.length},productsParams(){return this.$store.state.products.productsParams},width(){let e=[];return this.fields.forEach((t=>{let s=0;9==t.type&&(s=90),7!=t.type&&8!=t.type||(s=150),e.push(s)})),e}},methods:{isShow(e){let t=!1;return Object.entries(this.tableConfig).forEach((s=>{s[0].split(".")[0]==e&&s[1]?.visible&&(t=!0)})),t},dropOrder(){this.order={code:"",prev_order:""}},sort(e){const t=["asc","desc"];let s="";s=this.order.code===e&&this.order.prev_order==t[0]?t[1]:t[0],this.order={code:e,prev_order:s},e.split(".").length>1&&(e=e.split(".").join("->")),this.$emit("sort",e,s)},async exportXlsx(){this.disableExportXlsx=!0,this.$store.commit("openCloseTaskCenter",!0),setTimeout((()=>{this.$store.commit("openCloseTaskCenter",!1)}),5e3);const{sort:e,filter:t}=this.productsParams,s=[];Object.entries(this.tableConfig).filter((e=>e[1].visible)).sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0)).forEach((e=>s.push(e[0])));const i={sort:e,filter:t,config:s};this.$store.dispatch("exportXlsx",i)},changeAllSelectedProducts(){this.$emit("changeAllSelectedProducts",this.allSelectedProducts)},dropAllSelectedProducts(){this.allSelectedProducts=!1},openTableSettings(){this.$store.commit("toggleShowTableSettings",!0)}}};const fi=(0,Oe.Z)(mi,[["render",vi],["__scopeId","data-v-5e8633ea"]]);var wi=fi;function yi(e,t,s,i,a,o){const n=(0,l.up)("AppPaginator"),r=(0,l.up)("ImportStuffSelector");return s.show?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,d.C_)(["bottom",{blur:s.blur}])},[s.showBtns?((0,l.wg)(),(0,l.j4)(n,{key:0,page:s.page,onChangePage:o.changePage},null,8,["page","onChangePage"])):(0,l.kq)("",!0),s.showSelector?((0,l.wg)(),(0,l.j4)(r,{key:1,class:"count",options_props:a.count_values,selected_option:{name:s.count,value:s.count},onSelect:o.change_count},null,8,["options_props","selected_option","onSelect"])):(0,l.kq)("",!0)],2)):(0,l.kq)("",!0)}const bi=e=>((0,l.dD)("data-v-de19fd14"),e=e(),(0,l.Cn)(),e),ki={class:"v-select"},Ci=bi((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),Li=[Ci],Pi={class:"options",key:"a1"},Di=["onClick"];function Wi(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",ki,[(0,l._)("div",{class:(0,d.C_)(["title",{title_checked:a.show_options,disabled:s.disabled}]),onClick:t[0]||(t[0]=e=>a.open_close_options()),onFocusout:t[1]||(t[1]=(...e)=>a.handleFocusOut&&a.handleFocusOut(...e)),ref:"title",tabindex:"0"},[(0,l._)("p",null,(0,d.zw)(s.selected_option.name),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,d.C_)(["arrow",{rotate_arrow:a.show_options}])},Li,2))],34),(0,l.Wm)(i.uT,{name:"list"},{default:(0,l.w5)((()=>[a.show_options?((0,l.wg)(),(0,l.iD)("div",Pi,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.options,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.value,class:(0,d.C_)({optgroup:"optgroup"===e.value,selected:e.value==s.selected_option.value}),onClick:t=>a.select_option(e)},[e.optgroup?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Uk)("     "+(0,d.zw)(e.name),1)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Uk)((0,d.zw)(e.name),1)],64))],10,Di)))),128))])):(0,l.kq)("",!0)])),_:1})])}const xi={props:{options_props:{type:Array,default(){return[]},required:!0},selected_option:{type:Object,required:!0,default(){return{}}},disabled:{type:Boolean,required:!1,default:!1},idx:{type:Number,required:!1}},emits:{select:null},setup(e,t){const s=(0,ze.iH)([]);(0,l.bv)((()=>{window.addEventListener("scroll",c),(0,l.Y3)((()=>{i()}))}));const i=()=>{s.value=[],e.options_props?.forEach((e=>s.value.push(e)))};(0,l.YP)((()=>e.options_props),(()=>{i()}),{deep:!0});const a=(0,ze.iH)(!1);(0,l.YP)(a,(()=>t.emit("toggleShowOptions",a.value)));const o=()=>{a.value=!1},d=()=>{e.disabled||(c(),a.value=!a.value)},n=()=>{o()},r=s=>{"optgroup"!=s.value&&(t.emit("select",s,e.idx),o())};(0,l.Ah)((()=>window.removeEventListener("scroll",c)));const c=()=>{const e=u.value?.getBoundingClientRect();p.value=e.width-2+"px",_.value=e.x+"px",h.value=e.bottom+"px"},u=(0,ze.iH)(null),p=(0,ze.iH)(null),_=(0,ze.iH)(null),h=(0,ze.iH)(null);return{open_close_options:d,handleFocusOut:n,show_options:a,options:s,select_option:r,title:u,optionsWidth:p,optionsX:_,optionsY:h}}},qi=()=>{(0,i.sj)((e=>({"078e15f0":e.optionsWidth,"6af4b8ba":e.optionsX,"6af4b8bb":e.optionsY})))},Ai=xi.setup;xi.setup=Ai?(e,t)=>(qi(),Ai(e,t)):qi;var Si=xi;const Vi=(0,Oe.Z)(Si,[["render",Wi],["__scopeId","data-v-de19fd14"]]);var Ti=Vi,Fi={components:{ImportStuffSelector:Ti,AppPaginator:Ke},props:{previous:{type:Boolean,required:!1},next:{type:Boolean,required:!1},page:{type:Object,required:!1,default(){return{first:1,prev:null,current:1,next:null,last:1}}},count:{type:Number,required:!0},blur:{type:Boolean,required:!1,default:!1},show:{type:Boolean,required:!1,default:!0},showBtns:{type:Boolean,required:!1,default:!0},showSelector:{type:Boolean,required:!1,default:!0}},emits:{changePage:null,changeCount:null},data(){return{count_values:[{name:"10",value:10},{name:"20",value:20},{name:"50",value:50}]}},mounted(){},computed:{},methods:{changePage(e){this.$emit("changePage",e)},change_count(e){this.$emit("changeCount",e.name)}}};const zi=(0,Oe.Z)(Fi,[["render",yi],["__scopeId","data-v-23c710ea"]]);var Ii=zi;const $i=e=>((0,l.dD)("data-v-15eea96d"),e=e(),(0,l.Cn)(),e),Hi={key:0},Yi=["src"],ji=["src"],Oi={key:0,class:"sls_navigation"},Ei=$i((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"currentColor",d:"M14.91 6.71a.996.996 0 0 0-1.41 0L8.91 11.3a.996.996 0 0 0 0 1.41l4.59 4.59a.996.996 0 1 0 1.41-1.41L11.03 12l3.88-3.88c.38-.39.38-1.03 0-1.41"})],-1))),Mi=[Ei],Bi=$i((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("g",{transform:"translate(24 0) scale(-1 1)"},[(0,l._)("path",{fill:"currentColor",d:"M14.91 6.71a.996.996 0 0 0-1.41 0L8.91 11.3a.996.996 0 0 0 0 1.41l4.59 4.59a.996.996 0 1 0 1.41-1.41L11.03 12l3.88-3.88c.38-.39.38-1.03 0-1.41"})])],-1))),Ri=[Bi],Ni={class:"sls_pagination"};function Ui(e,t,s,a,o,n){const r=(0,l.up)("AppImagesCaruselPreloader");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",null,[s.item?((0,l.wg)(),(0,l.iD)("label",Hi,(0,d.zw)(s.item)+":",1)):(0,l.kq)("",!0),s.imagesList?.length?((0,l.wg)(),(0,l.iD)("div",{key:1,class:(0,d.C_)(["sls_wrapper",["f"===s.sizeWindow?"w_full":"w_fit"]]),ref:e=>"f"===s.sizeWindow?a.refComp=e:null},[("f"===s.sizeWindow?a.images.isLoading:a.images.startLoading)?((0,l.wg)(),(0,l.j4)(r,{key:0,class:(0,d.C_)({size_14:"f"!==s.sizeWindow}),square:"f"!==s.sizeWindow},null,8,["class","square"])):(0,l.kq)("",!0),(0,l.wy)((0,l._)("img",{src:s.imagesList[a.images.selectedIdx],class:(0,d.C_)(["parentImg",{size_full:"f"===s.sizeWindow,size_14:"f"!==s.sizeWindow}]),alt:"Ошибка",onLoad:t[0]||(t[0]=()=>"f"===s.sizeWindow?a.images.load():a.images.startLoad())},null,42,Yi),[[i.F8,!("f"===s.sizeWindow?a.images.isLoading:a.images.startLoading)]]),"f"!==s.sizeWindow?((0,l.wg)(),(0,l.iD)("div",{key:1,class:(0,d.C_)(["main_wrapper hover_block",[{size_40:"m"===s.sizeWindow,size_52:"l"===s.sizeWindow,hover_hidden:"f"===s.sizeWindow}]]),style:(0,d.j5)([`${s.float}: 0`]),ref:e=>"f"===s.sizeWindow?null:a.refComp=e},[a.images.isLoading?((0,l.wg)(),(0,l.j4)(r,{key:0,square:"f"!==s.sizeWindow},null,8,["square"])):(0,l.kq)("",!0),(0,l.wy)((0,l._)("img",{src:s.imagesList[a.images.selectedIdx],class:"main_img",alt:"Ошибка",onLoad:t[1]||(t[1]=()=>a.images.load())},null,40,ji),[[i.F8,!a.images.isLoading]])],6)):(0,l.kq)("",!0)],2)):(0,l.kq)("",!0)]),null!==a.refComp?((0,l.wg)(),(0,l.j4)(l.lR,{key:0,to:a.refComp},[s.imagesList.length>1?((0,l.wg)(),(0,l.iD)("div",Oi,[(0,l._)("button",{class:"hf",onClick:t[2]||(t[2]=e=>a.images.pref(s.imagesList.length))},Mi),(0,l._)("button",{class:"hf",onClick:t[3]||(t[3]=e=>a.images.next(s.imagesList.length))},Ri)])):(0,l.kq)("",!0),(0,l._)("div",Ni,[(0,l._)("span",null,(0,d.zw)(a.images.selectedIdx+1+" / "+s.imagesList.length),1)])],8,["to"])):(0,l.kq)("",!0)],64)}const Zi=e=>((0,l.dD)("data-v-2d4452a2"),e=e(),(0,l.Cn)(),e),Ki=Zi((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"cvg_class",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"currentColor",d:"M19 2H5a3.009 3.009 0 0 0-3 3v8.86l3.88-3.88a3.075 3.075 0 0 1 4.24 0l2.871 2.887l.888-.888a3.008 3.008 0 0 1 4.242 0L22 15.86V5a3.009 3.009 0 0 0-3-3z",opacity:".5"}),(0,l._)("path",{fill:"currentColor",d:"M10.12 9.98a3.075 3.075 0 0 0-4.24 0L2 13.86V19a3.009 3.009 0 0 0 3 3h14a3 3 0 0 0 2.16-.92L10.12 9.98z"}),(0,l._)("path",{fill:"currentColor",d:"m22 15.858l-3.879-3.879a3.008 3.008 0 0 0-4.242 0l-.888.888l8.165 8.209c.542-.555.845-1.3.844-2.076v-3.142z",opacity:".25"})],-1))),Gi=[Ki];function Xi(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("div",{class:(0,d.C_)(["wrapper_preloader",{aspect_square:s.square,aspect_video:!s.square}])},Gi,2)}var Ji={props:{square:Boolean,default:()=>!0}};const Qi=(0,Oe.Z)(Ji,[["render",Xi],["__scopeId","data-v-2d4452a2"]]);var el=Qi,tl={components:{AppImagesCaruselPreloader:el},props:{imagesList:{type:Array,default:()=>[]},sizeWindow:{type:String,required:!1,default:()=>"l",validator:e=>["m","l","f"].includes(e)},float:{type:String,required:!1,default:()=>"left",validator:e=>["right","left"].includes(e)},item:{type:String,required:!1,default:()=>""}},setup(){const e=(0,ze.qj)({selectedIdx:0,isLoading:!1,startLoading:!0,startLoad:function(){this.startLoading=!1},load:function(){(0,l.Y3)((()=>this.isLoading=!1))},next:function(e){let t=this.selectedIdx+1;e<=t&&(t=0),this.selectedIdx=t},pref:function(e){let t=this.selectedIdx-1;t<0&&(t=e-1),this.selectedIdx=t}}),t=(0,ze.iH)(null);(0,l.YP)((()=>e.selectedIdx),(()=>e.isLoading=!0));const s=(0,ze.iH)(null);(0,l.YP)((()=>e.isLoading),(()=>{e.isLoading?s.value=setTimeout((()=>e.isLoading=!1),5e3):clearTimeout(s.value)}),{immediate:!0});const i=(0,ze.iH)(null);return(0,l.YP)((()=>e.startLoading),(()=>{e.startLoading?i.value=setTimeout((()=>e.startLoading=!1),5e3):clearTimeout(i.value)}),{immediate:!0}),{images:e,refComp:t}}};const sl=(0,Oe.Z)(tl,[["render",Ui],["__scopeId","data-v-15eea96d"]]);var il=sl,ll={name:"MainGrid",components:{TableSettings:Nt,MainGridFilters:Js,MainGridBar:wi,GridBottom:Ii,AppInputSelect:Me,AppImagesCarusel:il},props:{},emits:{accept:null},data(){return{isLoading:!1,inputValues:[],allWhsList:[],savedAllWhsList:[],showSpinner:!1}},computed:{page(){const e={first:this.getPageFromLink(this.meta?.links?.first),prev:this.getPageFromLink(this.meta?.links?.prev),current:this.meta?.meta?.current_page,next:this.getPageFromLink(this.meta?.links?.next),last:this.getPageFromLink(this.meta?.links?.last)};return e},count(){return this.productsParams?.per_page},meta(){return this.$store.state.products.meta},products(){return this.$store.state.products.allProducts},productsParams(){return this.$store.state.products.productsParams},all_fields(){return this.$store.state.fields.all_fields},tableConfig(){return this.$store.state.fields.tableConfig},selectedWirePerLead(){return this.$store.state.products.selectedWirePerLead},showTableSettings(){return this.$store.state.fields.showTableSettings},sortedFields(){const e=Object.entries(this.tableConfig);return e.sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0))},categories(){const e={};return this.$store.state.categories.fields_properties2.forEach((t=>e[t.id]=t.name)),e},savedAllWhsListIds(){const e=[];return this.savedAllWhsList.forEach((t=>e.push(t[0].product_id))),e}},async activated(){this.isLoading=!0,await Promise.all([this.$store.dispatch("getTableConfig",{account_id:30214471,code:"widget"}),this.$store.dispatch("get_fields_properties2",{account_id:30214471}),this.$store.dispatch("getAllFields",{account_id:30214471}),this.get_products(this.productsParams)]),this.isLoading=!1},deactivated(){},watch:{products:{handler:function(){this.fillAllWhsList()},deep:!0},allWhsList:{handler:function(){this.saveAllWhsList(),this.saveSelectedWirePerLead()},deep:!0}},methods:{async accept(){const e={};this.savedAllWhsList.forEach((t=>{t?.forEach((t=>{if(t.specialValue){const s={account_id:30214471,productId:t.is_service?t.product_id:t.product_id+"%%%"+t.code,count:t.specialValue};e[s.productId]=s.count}}))})),this.$store.dispatch("addProduct3",{products:e,account_id:30214471}),this.savedAllWhsList=[],this.allWhsList=[],this.$emit("changeSavedAllWhsList",this.savedAllWhsList),this.$emit("accept")},fillAllWhsList(){this.saveAllWhsList();const e=[];this.products.forEach((t=>{const s=this.savedAllWhsList.find((e=>e[0].product_id===t.id));if(s)e.push(s);else{const s=t.whs?.map((e=>({...e})));s.map((e=>{e.name=e.name+"   |   "+e.count,e.value=e.code,e.specialValue=null,e.product_id=t.id,e.is_service=t.is_service,e.product_name=t.fields?.name})),e.push(s)}})),this.allWhsList=e},saveAllWhsList(){const e=this.allWhsList.filter((e=>{const t=e.reduce(((e,t)=>e+Number(t.specialValue)),0);return t}));if(this.savedAllWhsList.length){const t={};this.savedAllWhsList.forEach(((s,i)=>{const l=s[0].product_id;e.forEach((e=>{e[0].product_id===l?this.savedAllWhsList[i]=e:this.savedAllWhsListIds.includes(e[0].product_id)||(t[e[0].product_id]=e)}))})),this.savedAllWhsList=[...this.savedAllWhsList,...Object.values(t)],this.savedAllWhsList=this.savedAllWhsList.filter((e=>e.reduce(((e,t)=>e+Number(t.specialValue)),0)))}else this.savedAllWhsList=[...this.savedAllWhsList,...e];this.$emit("changeSavedAllWhsList",this.savedAllWhsList)},deleteSavedAllWhsList(e){const t=this.savedAllWhsList[e]?.[0]?.product_id,s=this.allWhsList.find((e=>e[0]?.product_id===t));s&&s.map((e=>e.specialValue=null)),this.savedAllWhsList.splice(e,1),this.$emit("changeSavedAllWhsList",this.savedAllWhsList)},fillInputValues(){this.products.forEach((()=>this.inputValues.push("")))},getPageFromLink(e){return e?e.split("?page=")[1]:null},async clearFilters(){await(this.filters?.clearFilters()),this.filters?.confirmFilters()},confirmFilters(){this.filters?.confirmFilters()},async changeCount(e){this.$store.commit("updateProductsParams",{per_page:e}),this.drop_page()},changePage(e){const t={page:e};this.$store.commit("updateProductsParams",t),this.get_products(this.productsParams)},async get_products(e){this.showSpinner=!0,await this.$store.dispatch("getAllProducts",{...e,account_id:30214471,leadId:29768593}),this.fillInputValues(),this.showSpinner=!1},drop_page(){this.changePage(1)},sort(e,t){const s={page:1,sort:{by:e,order:t}};this.$store.commit("updateProductsParams",s),this.get_products(this.productsParams)},async closeTableSettings(){this.isLoading=!0,await Promise.all([this.$store.dispatch("getTableConfig",{account_id:30214471,code:"widget"}),this.$store.dispatch("getAllFields",{account_id:30214471}),this.get_products(this.productsParams)]),this.isLoading=!1},saveSelectedWirePerLead(){let e=null;this.products[0]?.one_wh_per_lead&&(e=this.savedAllWhsList[0]?.find((e=>e?.specialValue>0))?.code),e==this.selectedWirePerLead.value&&this.selectedWirePerLead.sources.includes("MG")||this.$store.commit("updateSelectedWirePerLead",{source:"MG",value:e})}}};const al=(0,Oe.Z)(ll,[["render",Dt],["__scopeId","data-v-d1f643ea"]]);var ol=al,dl={components:{MainGrid:ol},emits:{close:null},setup(e,t){const s=()=>{t.emit("close")},i=()=>{a.value=[],t.emit("accept"),s()},a=(0,ze.iH)([]),o=e=>{a.value=[...e]},d=(0,ze.iH)(null),n=e=>{d.value&&(0,l.Y3)((()=>d.value?.deleteSavedAllWhsList(e)))},r=()=>{d.value&&(0,l.Y3)((()=>d.value?.accept()))};return{close:s,accept:i,accepMainGridRef:r,savedAllWhsList:a,changeSavedAllWhsList:o,mainGridRef:d,deleteSavedAllWhsList:n}}};const nl=(0,Oe.Z)(dl,[["render",dt],["__scopeId","data-v-47b557c8"]]);var rl=nl,cl={components:{AppInputSelect:Me,FiltersModal:rl,AppPaginator:Ke,AppImagesCarusel:il},data(){return{show_cards:!1,show_filters:!1,selectedCategories:[],search:{value:"",list:[]},inputValues:[],allWhsList:[],showSpinner:!1,useSkeletonCard:!1}},computed:{...(0,be.Se)(["data","params"]),categories(){return this.$store.state.categories.categories},page(){const e={first:this.getPageFromLink(this.meta?.links?.first),prev:this.getPageFromLink(this.meta?.links?.prev),current:this.meta?.meta?.current_page,next:this.getPageFromLink(this.meta?.links?.next),last:this.getPageFromLink(this.meta?.links?.last)};return e},isDarkTheme(){return"dark"===$(".left-menu__themes-toggler").find(".themes-toggler__checkbox:checked").parent(".themes-toggler__item").find(".themes-toggler__content").text().trim()},meta(){return this.$store.state.products.meta2},productsParams(){return this.$store.state.products.productsParams2},categoriesForCard(){const e={};return this.$store.state.categories.fields_properties2.forEach((t=>e[t.id]=t.name)),e},selectedWirePerLead(){return this.$store.state.products.selectedWirePerLead},savedAllWhsList(){const e=this.allWhsList.filter((e=>{const t=e.reduce(((e,t)=>e+Number(t?.specialValue)),0);return t}));return e||[]},products(){return this.$store.state.products.products},fields(){return this.$store.state.fields.fields},disableAddToDeal(){return this.$store.state.products.disableAddToDeal},sortedFields(){return this.fields?.filter((e=>e.lead_config?.visible>0))},productsLength(){return this.products.length},isLastProductPerPage(){return this.meta.meta.from===this.meta.meta.to}},async mounted(){await Promise.all([this.getCategories(0),this.$store.dispatch("getAllFields",{account_id:30214471}),this.$store.dispatch("get_fields_properties2",{account_id:30214471})]),this.selectCategories(this.categories[0])},watch:{async show_cards(){this.show_cards||(this.selectedCategories=[],await this.getCategories(0),this.selectCategories(this.categories[0]))},allWhsList:{handler:function(){this.saveSelectedWirePerLead()},deep:!0}},methods:{getPageFromLink(e){return e?e.split("?page=")[1]:null},changePage(e){this.$store.commit("updateProductsParams2",{page:e}),this.getProducts(this.selectedCategories.at(-1)?.id),window.scrollTo(0,0)},dropPage(){this.changePage(1)},fillAllWhsList(){const e=[];this.products.forEach((t=>{const s=t.whs?.map((e=>({...e})));s.map((e=>{e.name=e.name+"   |   "+e.count,e.value=e.code,e.specialValue=null})),e.push(s)})),this.allWhsList=e},fillInputValues(){this.products.forEach((()=>this.inputValues.push("")))},async addToLeadAutocomplete(e){await this.$store.dispatch("addProduct",{account_id:30214471,productId:e}),this.updateProductsList()},async addToLead(e){const t=this.products.find((t=>t.id===e)),s=this.products.indexOf(t),i=await new Promise((i=>{(async()=>{if(t.is_service)await this.$store.dispatch("addProduct2",{account_id:30214471,productId:e,count:this.allWhsList[s][0]?.specialValue}),i();else{const t={};this.allWhsList[s].forEach((s=>{if(s?.specialValue){const i={account_id:30214471,productId:[e,s.code].join("%%%"),count:s?.specialValue};t[i.productId]=i.count}})),await this.$store.dispatch("addProduct3",{products:t,account_id:30214471}),i()}})()}));await i,this.updateProductsList()},updateProductsList(){this.show_cards&&(this.isLastProductPerPage&&this.page.current>1?this.changePage(this.page.current-1):this.getProducts(this.selectedCategories.at(-1)?.id))},async getProductsAutocomplete(e){this.search.value=e;const t=this.selectedCategories.at(-1)?.id,s={account_id:30214471,q:e};this.selectedWirePerLead.value&&(s.selected_wh=this.selectedWirePerLead.value),t&&(s.category_id=t),await this.$store.dispatch("getProductsAutocomplete",s);const i=this.$store.state.products.productsAutocomplete;i.map((e=>e.name=e.label)),this.search.list=i},async selectCategories(e){this.showSpinner=!0;const t=this.selectedCategories?.indexOf(e);-1!==t&&this.selectedCategories.splice(t,9999),this.selectedCategories.push(e),this.dropPage(),await Promise.all([this.getCategories(e.id),this.getProducts(e.id)]),1===this.selectedCategories.length&&await this.getFields(e.id),this.showSpinner=!1},async getCategories(e){await this.$store.dispatch("getCategories",{account_id:30214471,parent_id:e})},async getProducts(e){this.useSkeletonCard=!0,await this.$store.dispatch("getProducts2",{account_id:30214471,category_id:e,...this.productsParams}),this.fillInputValues(),this.fillAllWhsList(),this.useSkeletonCard=!1},async getFields(e){await this.$store.dispatch("getFields",{account_id:30214471,category_id:e,with_parents:1})},close_filters(){this.show_filters=!1},accept_filters(){this.updateProductsList()},feel_available_data(){this.data.forEach(((e,t)=>{const s={name:this.short_value(e),data:e,value:t};this.available_data.push(s)}))},search_value(e,t){const s=this.search_idx(e);if(-2!=s)return t[s]},search_idx(e){const t=this.params.indexOf(e)-1;return t},toggleShowData(e){const t=this.show_data[e];this.show_data=[],this.show_data[e]=!t},openModal(){return this.show_filters=!0,!1},saveSelectedWirePerLead(){let e=null;this.products[0]?.one_wh_per_lead&&(e=this.savedAllWhsList[0]?.find((e=>e?.specialValue>0))?.code),e==this.selectedWirePerLead.value&&this.selectedWirePerLead.sources.includes("MP")||this.$store.commit("updateSelectedWirePerLead",{source:"MP",value:e})}}};const ul=(0,Oe.Z)(cl,[["render",ye],["__scopeId","data-v-5e12e487"]]);var pl=ul,_l={name:"App",components:{MainPage:pl},setup(){}};const hl=(0,Oe.Z)(_l,[["render",o]]);var gl=hl,vl={state:{params:["","Название","Артикул","Себестоимость","Цена","Склад","На складе","Свободно для резерва","В резерве","№ партии","Поступление","НДС","Изменение","Единицы измерений","НДС %","НДС включен в цену","Менеджер может менять % НДС","Описание","Прибыль","Группа",""],data:[["Товар 1","1","500","509","Склад 1","509","50","51","1","2022-07-13","Да","2022-07-18T11:21","шт","3","Да","Да","123","Да","Группа 1"],["Товар 1","1","120","129","Склад 1","129","12","11","2","2022-07-13","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 1","1","300","309","Склад 1","309","30","31","2","2022-07-13","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 1","1","1500","1509","Склад 1","1509","150","151","3","2022-07-13","Да","2022-07-18T11:21","шт","3","Да","Да","123","Да","Группа 1"],["Товар 2","2","1800","1809","Склад 1","1809","180","181","1","2022-07-14","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 3","3","13","19","Склад 1","19","1","1","2","2022-07-18","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 4","4","117","119","Склад 1","119","11","11","3","2022-07-13","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 5","5","4356","4359","Склад 2","4359","435","431","2","2022-07-18","Да","2022-07-18T11:21","шт","3","Да","Да","123","Да","Группа 2"],["Товар 6","6","67589","67589","Склад 2","67589","6758","6751","2","2022-07-11","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"],["Товар 7","7","123","129","Склад 2","129","12","11","1","2022-07-11","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"],["Товар 8","8","123","129","Склад 2","129","12","11","1","2022-07-18","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"],["Товар 9","9","123","129","Склад 2","129","12","11","2","2022-07-11","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"],["Товар 9","9","123","129","Склад 2","129","12","11","3","2022-07-28","Да","2022-07-18T11:21","шт","3","Да","Да","123","Да","Группа 2"],["Товар 10","10","123","129","Склад 2","129","12","11","3","2022-07-16","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"]],service:[["Услуга 1","1","1500","1509","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 1"],["Продажа","1","1500","1509","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 1"],["Услуга 2","2","1800","1809","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 1"],["Услуга 3","3","13","19","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 1"],["Услуга 1","1","1500","1509","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","1234","Да","Группа 2"],["Услуга 1","1","1500","1509","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 2"]],types:[{name:"Число целое",value:1},{name:"Дробное число",value:2},{name:"Строка",value:3},{name:"Текст",value:4},{name:"Список",value:5},{name:"Мильтисписок",value:6},{name:"Дата",value:7},{name:"Дата-Время",value:8},{name:"Флаг",value:9}],fields:[{id:1,field:"Название",type:{name:"Строка",value:3},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:2,field:"Артикул",type:{name:"Строка",value:3},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:3,field:"Себестоимость",type:{name:"Дробное число",value:2},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:4,field:"Цена",type:{name:"Дробное число",value:2},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:5,field:"Склад",type:{name:"Список",value:5},selector_options:[{name:"Не выбрано",value:1},{name:"Склад 1",value:2},{name:"Склад 2",value:3}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:6,field:"На складе",type:{name:"Число целое",value:1},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:7,field:"Свободно для резерва",type:{name:"Число целое",value:1},selector_options:[{name:"",value:1}],disable_change_type:!1,visibility:!0,edit:!1,editing:!1,delete:!0,available_to_services:!1},{id:8,field:"В резерве",type:{name:"Число целое",value:1},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:9,field:"№ партии",type:{name:"Число целое",value:1},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:10,field:"Поступление",type:{name:"Дата",value:7},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:11,field:"НДС",type:{name:"Флаг",value:9},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:12,field:"Изменение",type:{name:"Дата-Время",value:8},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:13,field:"Единицы измерений",type:{name:"Список",value:5},selector_options:[{name:"Не выбрано",value:1},{name:"шт",value:2},{name:"л (литры)",value:3},{name:"м3 (кубические метры)",value:4},{name:"кг (килограммы)",value:5},{name:"т (тонны)",value:6},{name:"комплект",value:7},{name:"услуга",value:8}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:14,field:"НДС %",type:{name:"Дробное число",value:2},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:15,field:"НДС включен в цену",type:{name:"Флаг",value:9},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:16,field:"Менеджер может менять % НДС",type:{name:"Флаг",value:9},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:17,field:"Описание",type:{name:"Текст",value:4},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:18,field:"Прибыль",type:{name:"Флаг",value:9},selector_options:[{name:"",value:1}],disable_change_type:!1,visibility:!1,edit:!1,editing:!1,delete:!0,available_to_services:!0},{id:19,field:"Группа",type:{name:"Мильтисписок",value:6},selector_options:[{name:"Не выбрано",value:1},{name:"Группа 1",value:2},{name:"Группа 2",value:3},{name:"Группа 3",value:4},{name:"Группа 4",value:5}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0}]},getters:{data(e){return e.data},data1(e){return e.data},get_data_storage(e){const t=e.params.indexOf("Склад")-1,s={};let i=[],l=null;return e.fields.forEach((e=>{"Склад"==e.field&&(l=e.id-1)})),e.fields[l].selector_options.forEach((e=>{i.push(e.name)})),i.shift(),i.forEach((e=>{s[e]=[]})),i.forEach((i=>{e.data.forEach((e=>{e[t]==i&&s[i].push(e)}))})),s},service(e){return e.service},params(e){return e.params},types(e){return e.types},fields(e){return e.fields},options_from_name:e=>{const t={};return e.fields.forEach((e=>{t[e.field]=e.selector_options})),t}},mutations:{update_data(e,t){e.data=t},update_data_idx(e,t){e.data[t.idx]=t.data},update_all_data(e,t){e.data.forEach(((s,i)=>{e.data[i].push(t)}))},add_new_data(e,t){let s=[];e.params.forEach((()=>s.push(""))),s.pop(),s.pop(),t.title.forEach(((i,l)=>{const a=e.params.indexOf(i)-1;a>=0&&(s[a]=t.new_data[l])})),e.data.push(s)},cancel_item_in_data(e,t){const s=e.params.indexOf(t.name)-1,i=e.data[t.idx][s];e.data[t.idx][s]=i-t.count},delete_data_idx(e,t){e.data.forEach(((s,i)=>{t.forEach((t=>{e.data[i].splice(t,1)}))}))},remove_data_idx(e,t){e.data.splice(t.idx,1)},add_data(e,t){e.data.push(t.data)},archive_data(e,t){t.forEach((t=>{e.archive.items.push(e.data[t]),e.archive.sourses.push(0)}));const s=t.reverse();s.forEach((t=>e.data.splice(t,1)))},update_params(e,t){e.params=t},update_fields(e,t){e.fields=t}},actions:{}};function ml(){const e=e=>{let t="";return Object.entries(e).forEach(((e,s)=>{t+=0===s?"?":"&",t+=e[0]+"="+e[1]})),t};return{preparation_params:e}}const{preparation_params:fl}=ml();var wl={state:{categories:[],fields_properties:[],fields_properties2:[]},getters:{},mutations:{updateCategories(e,t){e.categories=[...t]},update_fields_properties(e,t){e.fields_properties=[...t]},update_fields_properties2(e,t){e.fields_properties2=[...t]}},actions:{async getCategories(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Wl?.apiRequest("categories",t,(async t=>{i=await t,e.commit("updateCategories",i),s(i)}))})()}));return s},async get_fields_properties(e,t){let s=[];return delete t.account_id,delete t.user,Wl?.apiRequest("category/list",t,(t=>{s=t,e.commit("update_fields_properties",s)})),s},async get_fields_properties2(e,t){let s=[];return delete t.account_id,delete t.user,Wl?.apiRequest("categories/list",t,(t=>{s=t,e.commit("update_fields_properties2",s)})),s}}};function yl(){const e=e=>(e.map((e=>{Dl.state.fields?.all_fields.forEach((t=>{null!==e.fields&&void 0!==e.fields||(e.fields={}),1!==t.type&&2!==t.type||(void 0===e.fields?.[t.code]||null===e.fields?.[t.code]?e.fields[t.code]=0:e.fields[t.code]=Number(e.fields[t.code])),3!==t.type&&4!==t.type||(void 0===e.fields?.[t.code]||null===e.fields?.[t.code]?e.fields[t.code]="":e.fields[t.code]=String(e.fields[t.code])),5!==t.type&&6!==t.type||void 0!==e.fields?.[t.code]&&null!==e.fields?.[t.code]||(e.fields[t.code]=""),7!==t.type&&8!==t.type||void 0!==e.fields?.[t.code]&&null!==e.fields?.[t.code]||(e.fields[t.code]=""),9===t.type&&(void 0===e.fields?.[t.code]||null===e.fields?.[t.code]?e.fields[t.code]=!1:("0"===e.fields?.[t.code]&&(e.fields[t.code]=!1),"1"===e.fields?.[t.code]?e.fields[t.code]=!0:e.fields[t.code]=Boolean(e.fields[t.code]))),11===t.type&&(void 0!==e.fields?.[t.code]&&null!==e.fields?.[t.code]||(e.fields[t.code]={cost:0,currency:"RUB",is_manager_can_change_nds:!1,is_nds:!1,is_price_include_nds:!1,nds:0}),void 0===e.fields[t.code]?.cost||null===e.fields[t.code]?.cost?e.fields[t.code].cost=0:e.fields[t.code].cost=Number(e.fields[t.code].cost),void 0===e.fields[t.code]?.currency||null===e.fields[t.code]?.currency?e.fields[t.code].currency="":e.fields[t.code].currency=String(e.fields[t.code].currency),void 0===e.fields[t.code]?.is_manager_can_change_nds||null===e.fields[t.code]?.is_manager_can_change_nds?e.fields[t.code].is_manager_can_change_nds=!1:("0"===e.fields[t.code].is_manager_can_change_nds&&(e.fields[t.code].is_manager_can_change_nds=!1),"1"===e.fields[t.code].is_manager_can_change_nds?e.fields[t.code].is_manager_can_change_nds=!0:e.fields[t.code].is_manager_can_change_nds=Boolean(e.fields[t.code].is_manager_can_change_nds)),void 0===e.fields[t.code]?.is_nds||null===e.fields[t.code]?.is_nds?e.fields[t.code].is_nds=!1:("0"===e.fields[t.code].is_nds&&(e.fields[t.code].is_nds=!1),"1"===e.fields[t.code].is_nds?e.fields[t.code].is_nds=!0:e.fields[t.code].is_nds=Boolean(e.fields[t.code].is_nds)),void 0===e.fields[t.code]?.is_price_include_nds||null===e.fields[t.code]?.is_price_include_nds?e.fields[t.code].is_price_include_nds=!1:("0"===e.fields[t.code].is_price_include_nds&&(e.fields[t.code].is_price_include_nds=!1),"1"===e.fields[t.code].is_price_include_nds?e.fields[t.code].is_price_include_nds=!0:e.fields[t.code].is_price_include_nds=Boolean(e.fields[t.code].is_price_include_nds)),void 0===e.fields[t.code]?.nds||null===e.fields[t.code]?.nds?e.fields[t.code].nds=0:e.fields[t.code].nds=Number(e.fields[t.code].nds)),13===t.type&&(void 0!==e.fields?.[t.code]&&null!==e.fields?.[t.code]||(e.fields[t.code]={count:0,reserve:0}),void 0===e.fields[t.code]?.count||null===e.fields[t.code]?.count?e.fields[t.code].count=0:e.fields[t.code].count=Number(e.fields[t.code].count),void 0===e.fields[t.code]?.reserve||null===e.fields[t.code]?.reserve?e.fields[t.code].reserve=0:e.fields[t.code].reserve=Number(e.fields[t.code].reserve))}))})),e);return{preparationProducts:e}}const{preparationProducts:bl}=yl(),{preparation_params:kl}=ml();var Cl={state:{products:[],productsAutocomplete:[],allProducts:[],meta:{links:{},meta:{}},meta2:{links:{},meta:{}},productsParams:{page:1,filter:{},sort:{},per_page:20},productsParams2:{page:1,per_page:12},selectedWirePerLead:{sources:[],value:null},disableAddToDeal:!1},getters:{},mutations:{updateDisableAddToDeal(e,t){e.disableAddToDeal=t},updateProducts(e,t){e.products=[...t]},updateProductsAutocomplete(e,t){e.productsAutocomplete=[...t]},updateAllProducts(e,t){e.allProducts=[...bl(t)]},update_meta(e,t){e.meta={...t}},update_meta2(e,t){e.meta2={...t}},updateProductsParams(e,t){Object.assign(e.productsParams,t)},updateProductsParams2(e,t){Object.assign(e.productsParams2,t)},updateSelectedWirePerLead(e,t){const s=0==e.selectedWirePerLead.sources.length,i=e.selectedWirePerLead.sources.includes(t.source),l=i&&1==e.selectedWirePerLead.sources.length,a=e.selectedWirePerLead.value===t.value;s&&t.value?e.selectedWirePerLead={sources:[t.source],value:t.value}:l?t.value?e.selectedWirePerLead.value=t.value:e.selectedWirePerLead={sources:[],value:null}:!i&&a&&t.value?e.selectedWirePerLead={sources:[...e.selectedWirePerLead.sources,t.source],value:t.value}:i&&!t.value&&(e.selectedWirePerLead.sources=e.selectedWirePerLead.sources.filter((e=>e!=t.source)))}},actions:{async getProductsAutocomplete(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Wl?.apiRequest("get-products-autocomplete",t,(async t=>{i=await t,e.commit("updateProductsAutocomplete",i),s(i)}))})()}));return s},async getProducts(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Wl?.apiRequest("products",t,(async t=>{e.commit("updateProducts",t),i=await t,s(i)}))})()}));return s},async getProducts2(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Wl?.apiRequest("products-v2",t,(async t=>{i=await t,e.commit("updateProducts",i.data),e.commit("update_meta2",{meta:i.meta,links:i.links}),s(i)}))})()}));return s},async getAllProducts(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,delete t.leadId,t.leadId=Wl?.AMOCRM.data.current_card.id,Wl?.apiRequest("products/filtered",t,(async t=>{i=await t,e.commit("updateAllProducts",i.data),e.commit("update_meta",{links:i.links,meta:i.meta}),s(i)}))})()}));return s},async addProduct(e,t){e.commit("updateDisableAddToDeal",!0);const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Wl?.addProduct(Wl?.AMOCRM?.data?.current_card?.id,t.productId,(()=>{e.commit("updateDisableAddToDeal",!1),s(i)}))})()}));return s},async addProduct2(e,t){e.commit("updateDisableAddToDeal",!0);const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Wl?.addProduct2(Wl?.AMOCRM?.data?.current_card?.id,t.productId,t.count,(()=>{e.commit("updateDisableAddToDeal",!1),s(i)}))})()}));return s},async addProduct3(e,t){e.commit("updateDisableAddToDeal",!0);const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Wl?.addProduct3(Wl?.AMOCRM?.data?.current_card?.id,t.products,(()=>{e.commit("updateDisableAddToDeal",!1),s(i)}))})()}));return s}}};const{preparation_params:Ll}=ml();var Pl={state:{fields:[],all_fields:[],tableConfig:{},showTableSettings:!1},getters:{},mutations:{toggleShowTableSettings(e,t){e.showTableSettings=t},updateFields(e,t){e.fields=[...t]},updateTableConfig(e,t){e.tableConfig={...t}},update_all_fields(e,t){const s=t.sort(((t,s)=>e.tableConfig[t.code]?.sort>e.tableConfig[s.code]?.sort?1:e.tableConfig[t.code]?.sort==e.tableConfig[s.code]?.sort?0:e.tableConfig[t.code]?.sort<e.tableConfig[s.code]?.sort?-1:void 0));e.all_fields=[...s]}},actions:{async getFields(e,t){let s=[];return delete t.account_id,delete t.user,Wl?.apiRequest("fields",t,(t=>{s=t,e.commit("updateFields",s)})),s},async getAllFields(e,t){let s=[];return delete t.account_id,delete t.user,Wl?.apiRequest("fields/all",t,(t=>{s=t,e.commit("update_all_fields",s)})),s},async getTableConfig(e,t){let s=[];return delete t.account_id,delete t.user,Wl?.apiRequest("products/filtered/config",t,(t=>{s=t,e.commit("updateTableConfig",s?.table)})),s},async updateTableConfig(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,delete t.leadId,t.leadId=Wl?.AMOCRM.data.current_card.id,Wl?.apiRequest("products/filtered/config/update",t,(async t=>{i=await t,e.commit("updateTableConfig",i?.table),s(i)}))})()}));return s}}},Dl=(0,be.MT)({modules:{data:vl,categories:wl,products:Cl,fields:Pl}});let Wl=null;const xl={render(e){return Wl=e,e.showProductsSearch((e=>{const t=(0,i.ri)({render:()=>(0,l.h)(gl)});t.use(Dl),t.mount(e)})),!0},init(){return!0},bind_actions(){return!0},settings(){},onSave(){},destroy(){},contacts_selected(){},leads_selected(){},tasks_selected(){}};$("body").data("WidgetVueProductsSearch",xl);var ql=xl;(0,i.ri)(gl).use(Dl).mount("#test")}},t={};function s(i){var l=t[i];if(void 0!==l)return l.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,i,l,a){if(!i){var o=1/0;for(c=0;c<e.length;c++){i=e[c][0],l=e[c][1],a=e[c][2];for(var d=!0,n=0;n<i.length;n++)(!1&a||o>=a)&&Object.keys(s.O).every((function(e){return s.O[e](i[n])}))?i.splice(n--,1):(d=!1,a<o&&(o=a));if(d){e.splice(c--,1);var r=l();void 0!==r&&(t=r)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[i,l,a]}}(),function(){s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={179:0};s.O.j=function(t){return 0===e[t]};var t=function(t,i){var l,a,o=i[0],d=i[1],n=i[2],r=0;if(o.some((function(t){return 0!==e[t]}))){for(l in d)s.o(d,l)&&(s.m[l]=d[l]);if(n)var c=n(s)}for(t&&t(i);r<o.length;r++)a=o[r],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(c)},i=self["webpackChunkwidget_test_3"]=self["webpackChunkwidget_test_3"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(326)}));return i=s.O(i),i}()}));
//# sourceMappingURL=main.js.map