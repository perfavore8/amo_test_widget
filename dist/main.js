define((function(){return function(){"use strict";var e={871:function(e,t,s){s.r(t),s.d(t,{amoWidjetSelf:function(){return Di},default:function(){return Li}});var i=s(242),l=s(396);const a={id:"myVue"};function o(e,t,s,i,o,n){const d=(0,l.up)("main-page");return(0,l.wg)(),(0,l.iD)("div",a,[(0,l.Wm)(d)])}var n=s(139);const d=e=>((0,l.dD)("data-v-678f9d08"),e=e(),(0,l.Cn)(),e),r={class:"app"},c={class:"container1"},u=d((()=>(0,l._)("div",{class:"header"},null,-1))),p={class:"content"},_={class:"top"},h={class:"btns"},v=d((()=>(0,l._)("label",{for:"grid"},null,-1))),g=d((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"white",d:"M12 19q-.425 0-.713-.288T11 18v-5H6q-.425 0-.713-.288T5 12q0-.425.288-.713T6 11h5V6q0-.425.288-.713T12 5q.425 0 .713.288T13 6v5h5q.425 0 .713.288T19 12q0 .425-.288.713T18 13h-5v5q0 .425-.288.713T12 19Z"})],-1))),f=[g],m={key:0,class:"bottom"},w={class:"links"},y=["disabled","onClick"],b={key:0,class:"spinner"},k=d((()=>(0,l._)("img",{src:"https://warehouse2.salesup.pro/images/spinner.gif",alt:"spinner"},null,-1))),C=[k],q={class:"path"},D={class:"categories grid"},x=["onClick"],L={class:"row title"},P=d((()=>(0,l._)("div",{class:"name"},null,-1))),V={class:"value"},A=d((()=>(0,l._)("div",{class:"row"},null,-1))),W={class:"products grid"},F={key:0,class:"text"},S={class:"row title"},H=d((()=>(0,l._)("div",{class:"name"},null,-1))),T={class:"value"},Y={class:"rows"},I={class:"row"},j={class:"name font-medium"},E={class:"value"},O={class:"row ml-1"},z=d((()=>(0,l._)("div",{class:"name"},"НДС :",-1))),B={class:"value"},M={class:"row ml-1"},R=d((()=>(0,l._)("div",{class:"name"},"НДС включен в цену :",-1))),U={class:"value"},N={class:"row"},Z={class:"name font-medium"},K=d((()=>(0,l._)("div",{class:"value"},null,-1))),G={class:"row ml-1"},X=d((()=>(0,l._)("div",{class:"name"},"На складе :",-1))),J={class:"value"},Q={class:"row ml-1"},ee=d((()=>(0,l._)("div",{class:"name"},"В резерве :",-1))),te={class:"value"},se={key:3,class:"row"},ie={class:"name"},le={class:"value"},ae={class:"card_footer"},oe={key:0},ne=["onUpdate:modelValue"],de={key:1},re=["onClick"],ce=d((()=>(0,l._)("div",{class:"footer"},null,-1)));function ue(e,t,s,a,o,d){const g=(0,l.up)("AppInputSelect"),k=(0,l.up)("filters-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",r,[(0,l._)("div",c,[u,(0,l._)("div",p,[(0,l._)("div",_,[(0,l.Wm)(g,{list:o.search.list,value:o.search.value,placeholder:"Добавление (поиск на складе по названию или артикулу)...",countLettersReq:3,onChangeInputValue:d.getProductsAutocomplete,onSelect:t[0]||(t[0]=e=>d.addToLeadAutocomplete(e.id))},null,8,["list","value","placeholder","onChangeInputValue"]),(0,l._)("div",h,[(0,l.wy)((0,l._)("input",{type:"checkbox",class:"sls_checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>o.show_cards=e),id:"grid"},null,512),[[i.e8,o.show_cards]]),v,(0,l._)("div",{class:"sls_btn",id:"sls_btn_open_filter",onClick:t[2]||(t[2]=e=>d.openModal())},f)])]),(0,l.Wm)(i.uT,{name:"rows"},{default:(0,l.w5)((()=>[o.show_cards?((0,l.wg)(),(0,l.iD)("div",m,[(0,l._)("div",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.selectedCategories,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,n.C_)(["triangle",{triangle_last:!d.categories.length&&o.selectedCategories.length-1==t}]),disabled:!d.categories.length&&o.selectedCategories.length-1==t,key:e,onClick:t=>d.selectCategories(e)},(0,n.zw)(e?.name),11,y)))),128))]),o.showSpinner?((0,l.wg)(),(0,l.iD)("div",b,C)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l._)("div",q,[(0,l._)("div",D,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.categories,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"card",key:e,onClick:t=>d.selectCategories(e)},[(0,l._)("div",L,[P,(0,l._)("div",V,(0,n.zw)(e.name),1)]),A],8,x)))),128))])]),(0,l._)("div",W,[0==d.products.length?((0,l.wg)(),(0,l.iD)("label",F," Ничего не найдено ")):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(d.products,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"card",key:e},[(0,l._)("div",S,[H,(0,l._)("div",T,(0,n.zw)(e?.fields?.name),1)]),(0,l._)("div",Y,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.sortedFields,(t=>((0,l.wg)(),(0,l.iD)(l.HY,{key:t},[t.lead_config.visible>0?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[11===t.type?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",I,[(0,l._)("div",j,(0,n.zw)(t.name)+" : ",1),(0,l._)("div",E,(0,n.zw)(e?.fields[t.code]?.cost?e?.fields[t.code]?.cost:(e?.fields[t.code]?.currency,e?.fields[t.code]?.currency)),1)]),e?.fields[t.code]?.is_nds?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",O,[z,(0,l._)("div",B,(0,n.zw)(e?.fields[t.code]?.nds),1)]),(0,l._)("div",M,[R,(0,l._)("div",U,(0,n.zw)(e?.fields[t.code]?.is_price_include_nds?"Да":"Нет"),1)])],64)):(0,l.kq)("",!0)],64)):13===t.type?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l._)("div",N,[(0,l._)("div",Z,(0,n.zw)(t.name)+" : ",1),K]),(0,l._)("div",G,[X,(0,l._)("div",J,(0,n.zw)(e?.fields[t.code]?.count),1)]),(0,l._)("div",Q,[ee,(0,l._)("div",te,(0,n.zw)(e?.fields[t.code]?.reserve),1)])],64)):"name"===t.code?((0,l.wg)(),(0,l.iD)(l.HY,{key:2},[],64)):((0,l.wg)(),(0,l.iD)("div",se,[(0,l._)("div",ie,(0,n.zw)(t.name)+" :",1),(0,l._)("div",le,(0,n.zw)(e?.fields[t.code]),1)]))],64)):(0,l.kq)("",!0)],64)))),128))]),(0,l._)("div",ae,[e.is_service?((0,l.wg)(),(0,l.iD)("div",oe,[o.allWhsList?.[t]?.length?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input",style:{"min-width":"70px"},"onUpdate:modelValue":e=>o.allWhsList[t][0].specialValue=e},null,8,ne)),[[i.nr,o.allWhsList[t][0].specialValue]]):(0,l.kq)("",!0)])):((0,l.wg)(),(0,l.iD)("div",de,[o.allWhsList?.[t]?.length?((0,l.wg)(),(0,l.j4)(g,{key:0,style:{"min-width":"70px"},list:o.allWhsList?.[t]?.filter((s=>s?.name?.toLowerCase()?.includes(o.inputValues[t]?.toLowerCase())&&(e.allow_add_with_zero_count||!(s.count<1)))),special:!0,requestDelay:0,countLettersReq:0,allow_add_with_zero_count:e.allow_add_with_zero_count,placeholder:o.allWhsList?.[t]?.reduce(((e,t)=>e+Number(t?.specialValue)),0),onChangeInputValue:e=>o.inputValues[t]=e},null,8,["list","allow_add_with_zero_count","placeholder","onChangeInputValue"])):(0,l.kq)("",!0)])),(0,l._)("div",{class:"sls_btn btn_del",onClick:t=>d.addToLead(e.id)}," Добавить к сделке ",8,re)])])))),128))])],64))])):(0,l.kq)("",!0)])),_:1})]),ce])]),((0,l.wg)(),(0,l.j4)(l.lR,{to:"body"},[(0,l.Wm)(i.uT,{name:"rows"},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.j4)(l.Ob,null,[o.show_filters?((0,l.wg)(),(0,l.j4)(k,{key:0,onClose:d.close_filters,onUpdate_changeValue:d.update_changeValue},null,8,["onClose","onUpdate_changeValue"])):(0,l.kq)("",!0)],1024))])),_:1})]))],64)}var pe=s(65);const _e=e=>((0,l.dD)("data-v-001e89e3"),e=e(),(0,l.Cn)(),e),he={class:"input-select"},ve=["placeholder"],ge={key:0,class:"list top",ref:"listRef"},fe=["onClick"],me=["onUpdate:modelValue"],we={key:0,class:"placeholder"},ye=_e((()=>(0,l._)("div",null,[(0,l._)("div",{class:"title"}),(0,l._)("div",{class:"text"})],-1))),be=_e((()=>(0,l._)("div",{class:"aside"},null,-1))),ke=[ye,be];function Ce(e,t,s,a,o,d){return(0,l.wg)(),(0,l.iD)("div",he,[(0,l.wy)((0,l._)("input",{type:"text",class:(0,n.C_)(["sls_input",{input_uderline:s.input_uderline,black_text:s.SelectedInTitle&&s.selected?.name}]),"onUpdate:modelValue":t[0]||(t[0]=e=>a.inputValue=e),onClick:t[1]||(t[1]=e=>a.openList()),placeholder:s.SelectedInTitle&&s.selected?.name?s.selected?.name:s.placeholder,ref:"title"},null,10,ve),[[i.nr,a.inputValue]]),a.showList?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",{class:"backdrop",onClick:t[2]||(t[2]=e=>a.closeList())}),(0,l.Wm)(i.W3,{name:"list"},{default:(0,l.w5)((()=>[s.list.length?((0,l.wg)(),(0,l.iD)("ul",ge,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.list,(e=>((0,l.wg)(),(0,l.iD)("li",{class:(0,n.C_)(["item",{selected:e.value===s.selected?.value}]),key:e.value,onClick:t=>a.selectItem(e)},[s.special?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input","onUpdate:modelValue":t=>e.specialValue=t,style:{width:"100px","min-width":"1%"},placeholder:"введите кол-во"},null,8,me)),[[i.nr,e.specialValue]]):(0,l.kq)("",!0),(0,l.Uk)(" "+(0,n.zw)(e.name),1)],10,fe)))),128))],512)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[a.showPlaceholder?((0,l.wg)(),(0,l.iD)("div",we,[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(4,(e=>(0,l._)("div",{class:"item",key:e},ke))),64))])):(0,l.kq)("",!0)],64))])),_:1})],64)):(0,l.kq)("",!0)])}var qe=s(870),De=s(466);const xe={props:{list:Array,selected:{type:Object,required:!1},countLettersReq:{type:Number,required:!1,default:()=>0},requestDelay:{type:Number,required:!1,default:()=>300},placeholder:{type:String,required:!1},input_uderline:{type:Boolean,required:!1,default:()=>!1},SelectedInTitle:{type:Boolean,required:!1,default:()=>!1},special:{type:Boolean,required:!1,default:()=>!1},allow_add_with_zero_count:{type:Boolean,required:!1,default:()=>!1}},emits:["changeInputValue","focusIn","select"],setup(e,t){const s=(0,qe.iH)(""),i=(0,qe.iH)(null),a=(0,qe.iH)(!1),o=()=>{a.value=!1,clearTimeout(i.value),s.value.length>=e.countLettersReq&&(a.value=!0,i.value=setTimeout((()=>{t.emit("changeInputValue",s.value),setTimeout((()=>a.value=!1),3*e.requestDelay)}),e.requestDelay))};(0,l.YP)(s,(()=>o()));const n=(0,qe.iH)(!1),d=()=>n.value=!1,r=()=>(n.value=!0,c(),o()),c=()=>t.emit("focusIn"),u=e=>{t.emit("select",e),d(),s.value=""};e.special&&(0,l.YP)(e.list,(()=>{e.list.map((t=>{t.specialValue>t.count&&!e.allow_add_with_zero_count&&(t.specialValue=t.count),t.specialValue<0&&(t.specialValue=0)}))}),{deep:!0}),(0,l.YP)(n,(()=>{(0,l.Y3)((()=>p()))}));const p=()=>{const e=_.value?.getBoundingClientRect();f.value=window.innerHeight-e.bottom+e.height+6+"px",h.value=e.width-2+"px",v.value=e.x+"px",g.value=e.bottom+6+"px",m.value&&(window.innerHeight-e.bottom+e.height+2<400?m.value.classList.contains("top")&&(m.value.classList.add("bottom"),m.value.classList.remove("top")):m.value.classList.contains("bottom")&&(m.value.classList.remove("bottom"),m.value.classList.add("top")))},_=(0,qe.iH)(null),h=(0,qe.iH)(null),v=(0,qe.iH)(null),g=(0,qe.iH)(null),f=(0,qe.iH)(null),m=(0,qe.iH)(null),w=(0,De.CDf)(_);return(0,l.YP)(w,(()=>{w.value?window.addEventListener("scroll",p):window.removeEventListener("scroll",p)})),{inputValue:s,showList:n,closeList:d,openList:r,selectItem:u,showPlaceholder:a,title:_,optionsWidth:h,optionsX:v,optionsY:g,optionsBottom:f,listRef:m,titleIsVisible:w}}},Le=()=>{(0,i.sj)((e=>({b886d818:e.optionsY,acce08e0:e.optionsBottom,ea82e87e:e.optionsWidth,b886d81a:e.optionsX})))},Pe=xe.setup;xe.setup=Pe?(e,t)=>(Le(),Pe(e,t)):Le;var Ve=xe,Ae=s(89);const We=(0,Ae.Z)(Ve,[["render",Ce],["__scopeId","data-v-001e89e3"]]);var Fe=We;const Se=e=>((0,l.dD)("data-v-3a71306a"),e=e(),(0,l.Cn)(),e),He={class:"app_modal"},Te={class:"container"},Ye={class:"header"},Ie={class:"saved"},je=["onClick"],Ee=Se((()=>(0,l._)("path",{fill:"red",d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12M8 9h8v10H8V9m7.5-5l-1-1h-5l-1 1H5v2h14V4h-3.5Z"},null,-1))),Oe=[Ee],$e=Se((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 15 15"},[(0,l._)("path",{fill:"currentColor","fill-rule":"evenodd",d:"M11.782 4.032a.575.575 0 1 0-.813-.814L7.5 6.687L4.032 3.218a.575.575 0 0 0-.814.814L6.687 7.5l-3.469 3.468a.575.575 0 0 0 .814.814L7.5 8.313l3.469 3.469a.575.575 0 0 0 .813-.814L8.313 7.5l3.469-3.468Z","clip-rule":"evenodd"})],-1))),ze=[$e],Be={class:"content"};function Me(e,t,s,i,a,o){const d=(0,l.up)("main-grid");return(0,l.wg)(),(0,l.iD)("div",He,[(0,l._)("div",{class:"sls_backdrop_with_filter",onClick:t[0]||(t[0]=e=>i.close())}),(0,l._)("div",Te,[(0,l._)("div",Ye,[(0,l._)("div",Ie,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.savedAllWhsList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{key:e,class:"item"},[(0,l.Uk)((0,n.zw)(e[0].product_name)+" : "+(0,n.zw)(e.reduce(((e,t)=>e+Number(t.specialValue)),0))+" ",1),((0,l.wg)(),(0,l.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",onClick:e=>i.deleteSavedAllWhsList(t)},Oe,8,je))])))),128))]),i.savedAllWhsList.length?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"sls_btn btn2",onClick:t[1]||(t[1]=e=>i.accepMainGridRef())}," Добавить к сделке ")):(0,l.kq)("",!0),(0,l._)("button",{class:"exit",onClick:t[2]||(t[2]=e=>i.close())},ze)]),(0,l._)("div",Be,[((0,l.wg)(),(0,l.j4)(l.Ob,null,[(0,l.Wm)(d,{onChangeSavedAllWhsList:i.changeSavedAllWhsList,onAccept:i.accept,class:"main_grid",ref:"mainGridRef"},null,8,["onChangeSavedAllWhsList","onAccept"])],1024))])])])}const Re=e=>((0,l.dD)("data-v-25204af6"),e=e(),(0,l.Cn)(),e),Ue={key:0,class:"wrapper"},Ne={class:"main"},Ze={class:"table",ref:"table"},Ke={key:0,class:"spinner"},Ge=Re((()=>(0,l._)("img",{src:"https://warehouse2.salesup.pro/images/spinner.gif",alt:"spinner"},null,-1))),Xe=[Ge],Je={key:0},Qe={class:"item"},et={key:0},tt=["onUpdate:modelValue"],st={key:1},it={key:0},lt={key:1},at={key:0,class:"text"},ot={class:"right"};function nt(e,t,s,a,o,d){const r=(0,l.up)("MainGridFilters"),c=(0,l.up)("main-grid-bar"),u=(0,l.up)("AppInputSelect"),p=(0,l.up)("grid-bottom");return o.isLoading?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",Ue,[d.all_fields.length&&d.tableConfig!={}&&d.sortedFields.length?((0,l.wg)(),(0,l.j4)(r,{key:0,ref:"filters",fields:d.all_fields,tableConfig:d.tableConfig,sortedFields:d.sortedFields,onConfirm:t[0]||(t[0]=()=>d.get_products(d.productsParams))},null,8,["fields","tableConfig","sortedFields"])):(0,l.kq)("",!0),(0,l._)("div",Ne,[(0,l._)("table",Ze,[(0,l._)("thead",null,[(0,l.Wm)(c,{ref:"bar",fields:d.all_fields,onSort:d.sort,tableConfig:d.tableConfig,sortedFields:d.sortedFields,class:"main-grid-bar"},null,8,["fields","onSort","tableConfig","sortedFields"])]),o.showSpinner?((0,l.wg)(),(0,l.iD)("div",Ke,Xe)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[d.products.length?((0,l.wg)(),(0,l.iD)("tbody",Je,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.products,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{class:"row",key:e.id},[(0,l._)("td",Qe,[e.is_service?((0,l.wg)(),(0,l.iD)("div",et,[o.allWhsList?.[t]?.length?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input",style:{"min-width":"70px"},"onUpdate:modelValue":e=>o.allWhsList[t][0].specialValue=e},null,8,tt)),[[i.nr,o.allWhsList[t][0].specialValue]]):(0,l.kq)("",!0)])):((0,l.wg)(),(0,l.iD)("div",st,[(0,l.Wm)(u,{style:{"min-width":"70px"},list:o.allWhsList?.[t]?.filter((s=>s?.name?.toLowerCase()?.includes(o.inputValues[t]?.toLowerCase())&&(e.allow_add_with_zero_count||!(s?.count<1)))),special:!0,requestDelay:0,countLettersReq:0,allow_add_with_zero_count:e.allow_add_with_zero_count,placeholder:o.allWhsList?.[t]?.reduce(((e,t)=>e+Number(t?.specialValue)),0),onChangeInputValue:e=>o.inputValues[t]=e},null,8,["list","allow_add_with_zero_count","placeholder","onChangeInputValue"])]))]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.sortedFields,(t=>((0,l.wg)(),(0,l.iD)("td",{key:t,class:"item"},[t[0].split(".").length<2?((0,l.wg)(),(0,l.iD)("span",it,(0,n.zw)("category"==t[0]?d.categories?.[e.fields?.[t?.[0]]]:9==t?.[1]?.type?e.fields?.[t[0]]?"Да":"Нет":"cost_price"==t[0]?e.fields?.[t[0]]?Math.round(100*e.fields?.[t[0]])/100:"0":e.fields?.[t[0]]),1)):((0,l.wg)(),(0,l.iD)("span",lt,(0,n.zw)("cost"==t[0].split(".")[1]?void 0==e.fields?.[t[0].split(".")[0]]?.[t[0]?.split(".")?.[1]]?"0":e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]+" "+(void 0==e.fields?.[t[0]?.split(".")?.[0]]?.currency||null==e.fields?.[t[0]?.split(".")?.[0]]?.currency?"":e.fields?.[t[0]?.split(".")?.[0]]?.currency):9==t[1].type?e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]?"Да":"Нет":e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]),1))])))),128))])))),128))])):(0,l.kq)("",!0)],64))],512),0==d.products.length?((0,l.wg)(),(0,l.iD)("label",at," Ничего не найдено ")):(0,l.kq)("",!0)]),(0,l._)("div",ot,[(0,l.Wm)(p,{page:d.page,blur:e.show_edit_modal,show:0!=d.products.length,count:d.count,onChangePage:d.changePage,onChangeCount:d.changeCount},null,8,["page","blur","show","count","onChangePage","onChangeCount"])])]))}const dt=e=>((0,l.dD)("data-v-6be94ca8"),e=e(),(0,l.Cn)(),e),rt={class:"wrapper"},ct={class:"filters"},ut={class:"item"},pt={key:0,class:"item"},_t={class:"title"},ht=["onClick"],vt=dt((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 15 15"},[(0,l._)("path",{fill:"currentColor","fill-rule":"evenodd",d:"M11.782 4.032a.575.575 0 1 0-.813-.814L7.5 6.687L4.032 3.218a.575.575 0 0 0-.814.814L6.687 7.5l-3.469 3.468a.575.575 0 0 0 .814.814L7.5 8.313l3.469 3.469a.575.575 0 0 0 .813-.814L8.313 7.5l3.469-3.468Z","clip-rule":"evenodd"})],-1))),gt=[vt],ft={class:"accept_btn"};function mt(e,t,s,i,a,o){const d=(0,l.up)("selector-vue"),r=(0,l.up)("filter-number"),c=(0,l.up)("filter-text"),u=(0,l.up)("filter-list"),p=(0,l.up)("filter-date"),_=(0,l.up)("filter-flag");return(0,l.wg)(),(0,l.iD)("div",rt,[(0,l._)("div",ct,[(0,l._)("div",ut,[(0,l.Wm)(d,{options_props:o.filteredFiltersValue,selected_option:{name:"Добавить фильтр",value:-1},onSelect:o.add_filter},null,8,["options_props","onSelect"])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.filtersValue,((e,t)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:t},[e.selected?((0,l.wg)(),(0,l.iD)("div",pt,[(0,l._)("div",_t,(0,n.zw)(e.name),1),1==e.type||2==e.type?((0,l.wg)(),(0,l.j4)(r,{key:0,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),3==e.type||4==e.type?((0,l.wg)(),(0,l.j4)(c,{key:1,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),5==e.type||6==e.type?((0,l.wg)(),(0,l.j4)(u,{key:2,item:e,idx:t,selector_options:e.selector_options,onChange_filter_value:o.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,l.kq)("",!0),12==e.type?((0,l.wg)(),(0,l.j4)(u,{key:3,item:e,idx:t,selector_options:a.categories_options,onChange_filter_value:o.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,l.kq)("",!0),7==e.type||8==e.type?((0,l.wg)(),(0,l.j4)(p,{key:4,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),9==e.type?((0,l.wg)(),(0,l.j4)(_,{key:5,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),(0,l._)("button",{class:"sls_remove",onClick:t=>o.remove_filter(e)},gt,8,ht)])):(0,l.kq)("",!0)],64)))),128))]),(0,l._)("div",ft,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>o.clearFilters()),class:"btn1 sls_btn"},"Очистить"),(0,l._)("button",{onClick:t[1]||(t[1]=e=>o.confirmFilters()),class:"btn2 sls_btn"},"Применить")])])}const wt={class:"filter"};function yt(e,t,s,a,o,d){return(0,l.wg)(),(0,l.iD)("div",wt,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>4==o.option?o.option=0:o.option+=1)},[(0,l._)("span",{class:(0,n.C_)({big:0==o.option})},(0,n.zw)(o.options[o.option]),3)]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.filterValue=e),type:"number"},null,512),[[i.nr,o.filterValue]])])}var bt={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{option:0,filterValue:null,options:["=",">",">=","<","<="]}},computed:{option_value(){return{option:this.options[this.option],value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=this.item.value,null==this.item.value&&(this.option=0)}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)}}};const kt=(0,Ae.Z)(bt,[["render",yt],["__scopeId","data-v-f983fcf0"]]);var Ct=kt;const qt={class:"filter"};function Dt(e,t,s,a,o,d){return(0,l.wg)(),(0,l.iD)("div",qt,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>1==o.option?o.option=0:o.option+=1)},[(0,l._)("span",null,(0,n.zw)(o.options[o.option]),1)]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.filterValue=e),type:"text"},null,512),[[i.nr,o.filterValue]])])}var xt={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{option:0,filterValue:null,options:["=","~"]}},computed:{option_value(){return{option:this.options[this.option],value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=this.item.value,null==this.item.value&&(this.option=0)}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)}}};const Lt=(0,Ae.Z)(xt,[["render",Dt],["__scopeId","data-v-3df224a4"]]);var Pt=Lt;const Vt=e=>((0,l.dD)("data-v-4b2b609a"),e=e(),(0,l.Cn)(),e),At={class:"filter"},Wt=Vt((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),Ft=[Wt];function St(e,t,s,i,a,o){const d=(0,l.up)("multi-selector");return(0,l.wg)(),(0,l.iD)("div",At,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>o.open_selector())},[(0,l._)("div",{class:(0,n.C_)(["arrow",{rotate_arrow:a.show_selector}])},Ft,2)]),a.show_selector?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",{class:"backdrop",onClick:t[1]||(t[1]=e=>o.closeSelector())}),(0,l.Wm)(d,{class:"selector",id:"selector123",options_props:[{name:"Все",value:""},...s.selector_options],onSelect:o.option_select_multi,selected_options:a.filterValue,tabindex:"1"},null,8,["options_props","onSelect","selected_options"])],64)):(0,l.kq)("",!0)])}const Ht={class:"multi_selector"},Tt=["onClick"];function Yt(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("div",Ht,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.options_props,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,n.C_)(["item",{selected:s.selected_options[t],disabled:s.disabled}]),key:e.value,onClick:e=>i.select(t)},(0,n.zw)(e.name),11,Tt)))),128))])}var It={name:"MultiSelector",props:{options_props:{type:Array,required:!0,default(){return[]}},selected_options:{type:Array,required:!0,default(){return[!0]}},disabled:{type:Boolean,required:!1,default(){return!1}}},emits:{select:null},setup(e,{emit:t}){const s=(0,qe.iH)([]);(0,l.bv)((()=>s.value=[...e.selected_options])),(0,l.YP)((()=>e.selected_options),(()=>{s.value=[...e.selected_options]}),{deep:!0});const i=i=>{e.disabled||(0==i&&(s.value=[]),1==s.value[0]&&(s.value[0]=!1),s.value[i]=!s.value[i],s.value.includes(!0)||(s.value[0]=!0),t("select",s.value))};return{options_value:s,select:i}}};const jt=(0,Ae.Z)(It,[["render",Yt],["__scopeId","data-v-46865b2c"]]);var Et=jt,Ot={components:{MultiSelector:Et},props:{item:{type:Object,required:!0},idx:{type:Number,required:!0},selector_options:{type:Array,required:!0}},data(){return{filterValue:[],show_selector:!1}},computed:{option_value(){return{value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=[!1],this.item.value.forEach(((e,t)=>{this.filterValue[t+1]=e}))}))},emit_value(){const e={value:[]},t=[{name:"Все",value:""},...this.selector_options];this.option_value.value.forEach(((s,i)=>s?12==this.item.type?e.value.push(t[i]?.value):e.value.push(t[i]?.name):null)),this.$emit("change_filter_value",e,this.idx)},option_select_multi(e){this.filterValue=e},open_selector(){this.show_selector=!0,(0,l.Y3)((()=>{this.show_selector&&document.getElementById("selector123").focus()}))},handleFocusOut(){setTimeout((()=>{(0,l.Y3)((()=>{this.show_selector=!1}))}),150)},closeSelector(){this.show_selector=!1}}};const $t=(0,Ae.Z)(Ot,[["render",St],["__scopeId","data-v-4b2b609a"]]);var zt=$t;const Bt={key:0,class:"filter"},Mt={key:1,class:"filter"};function Rt(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)(l.HY,null,[7==s.item.type?((0,l.wg)(),(0,l.iD)("div",Bt,[(0,l.wy)((0,l._)("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=e=>a.date_start=e)},null,512),[[i.nr,a.date_start]]),(0,l.wy)((0,l._)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>a.date_end=e)},null,512),[[i.nr,a.date_end]])])):(0,l.kq)("",!0),8==s.item.type?((0,l.wg)(),(0,l.iD)("div",Mt,[(0,l.wy)((0,l._)("input",{type:"datetime-local","onUpdate:modelValue":t[2]||(t[2]=e=>a.date_start=e)},null,512),[[i.nr,a.date_start]]),(0,l.wy)((0,l._)("input",{type:"datetime-local","onUpdate:modelValue":t[3]||(t[3]=e=>a.date_end=e)},null,512),[[i.nr,a.date_end]])])):(0,l.kq)("",!0)],64)}var Ut={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},emits:{change_filter_value:null},setup(e,{emit:t}){const s=(0,qe.iH)(""),i=(0,qe.iH)(""),a=(0,l.Fl)((()=>({value:`${s.value}~${i.value}`})));function o(){t("change_filter_value",a.value,e.idx)}function n(){if(e.item.value){const[t,l]=e.item.value.split("~");s.value=t,i.value=l}else s.value="",i.value=""}return(0,l.bv)((()=>{(0,l.Y3)((()=>{n()}))})),(0,l.YP)((()=>e.item.value),(()=>{n()})),(0,l.YP)(a,(()=>o())),{date_start:s,date_end:i,emit_value:o}}};const Nt=(0,Ae.Z)(Ut,[["render",Rt],["__scopeId","data-v-d5da7a74"]]);var Zt=Nt;const Kt={class:"filter"};function Gt(e,t,s,i,a,o){const n=(0,l.up)("selector-vue");return(0,l.wg)(),(0,l.iD)("div",Kt,[(0,l.Wm)(n,{options_props:i.options,onSelect:i.option_select,selected_option:i.options[i.filterValue-1]},null,8,["options_props","onSelect","selected_option"])])}const Xt=e=>((0,l.dD)("data-v-7da80cea"),e=e(),(0,l.Cn)(),e),Jt={class:"v-select"},Qt=Xt((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),es=[Qt],ts={class:"options",key:"a1"},ss=["onClick"],is={key:0,class:"material-icons-outlined opacity-50"};function ls(e,t,s,a,o,d){return(0,l.wg)(),(0,l.iD)("div",Jt,[(0,l._)("div",{class:(0,n.C_)(["title",{title_checked:a.show_options,disabled:s.disabled}]),onClick:t[0]||(t[0]=e=>a.open_close_options()),onFocusout:t[1]||(t[1]=(...e)=>a.handleFocusOut&&a.handleFocusOut(...e)),tabindex:"0"},[(0,l._)("p",null,(0,n.zw)(s.selected_option.name),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,n.C_)(["arrow",{rotate_arrow:a.show_options}])},es,2))],34),(0,l.Wm)(i.uT,{name:"list"},{default:(0,l.w5)((()=>[a.show_options?((0,l.wg)(),(0,l.iD)("div",ts,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.options,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.value,class:(0,n.C_)({optgroup:"optgroup"===e.value,selected:e.value==s.selected_option.value}),style:(0,n.j5)({backgroundColor:e.color}),onClick:t=>a.select_option(e)},[e.value==s.selected_option.value&&e.color?((0,l.wg)(),(0,l.iD)("span",is," check ")):(0,l.kq)("",!0),e.optgroup?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Uk)("     "+(0,n.zw)(e.name),1)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:2},[(0,l.Uk)((0,n.zw)(e.name),1)],64))],14,ss)))),128))])):(0,l.kq)("",!0)])),_:1})])}var as={props:{options_props:{type:Array,default(){return[]},required:!0},selected_option:{type:Object,required:!0,default(){return{}}},disabled:{type:Boolean,required:!1,default:!1},idx:{type:Number,required:!1}},emits:{select:null},setup(e,{emit:t}){const s=(0,qe.iH)([]);(0,l.bv)((()=>{(0,l.Y3)((()=>{i()}))}));const i=()=>{s.value=[],e.options_props?.forEach((e=>s.value.push(e)))};(0,l.YP)((()=>e.options_props),(()=>{i()}),{deep:!0});const a=(0,qe.iH)(!1),o=()=>{a.value=!1},n=()=>{e.disabled||(a.value=!a.value)},d=()=>{o()},r=s=>{"optgroup"!=s.value&&(t("select",s,e.idx),o())};return{open_close_options:n,handleFocusOut:d,show_options:a,options:s,select_option:r}}};const os=(0,Ae.Z)(as,[["render",ls],["__scopeId","data-v-7da80cea"]]);var ns=os,ds={components:{SelectorVue:ns},props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},setup(e,{emit:t}){const s=(0,qe.iH)([{name:"Все",value:1},{name:"Да",value:2},{name:"Нет",value:3}]),i=(0,qe.iH)(1),a=(0,l.Fl)((()=>({value:i.value})));(0,l.YP)(a,(()=>{t("change_filter_value",a.value,e.idx)}),{deep:!0});const o=()=>{(0,l.Y3)((()=>{i.value=e.item.value}))},n=e=>{i.value=e.value};return(0,l.YP)((()=>e.item),o),o(),{options:s,filterValue:i,option_value:a,option_select:n}}};const rs=(0,Ae.Z)(ds,[["render",Gt],["__scopeId","data-v-153ffddf"]]);var cs=rs,us={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},components:{FilterNumber:Ct,FilterText:Pt,FilterList:zt,FilterDate:Zt,FilterFlag:cs,SelectorVue:ns},data(){return{filtersValue:[],categories_options:[],isConfirmFilters:!1,filter:{}}},computed:{productsParams(){return this.$store.state.products.productsParams},filteredFiltersValue(){return this.filtersValue.filter((e=>!e.selected))}},async mounted(){Promise.all([this.$store.dispatch("get_fields_properties",{account_id:30214471}),this.$store.dispatch("get_fields_properties2",{account_id:30214471})]),this.get_categories_options(),this.feelFilters()},watch:{sortedFields:{handler:function(){this.feelFilters()},deep:!0}},methods:{add_filter(e){e.selected=!0},remove_filter(e){e.selected=!1;let t=null;5!=e.type&&6!=e.type||(t=[]),9==e.type&&(t=1),12==e.type&&(t=[]),e.value=t,this.confirmFilters()},searchTitle(e){let t="";const[s,i]=e.split(".");return t=this.fields.find((e=>e.code===s))?.name,"count"===i&&(t+=": на складе"),"reserve"===i&&(t+=": в резерве"),"is_nds"===i&&(t+=": с НДС"),"is_price_include_nds"===i&&(t+=": НДС включен в цену"),"nds"===i&&(t+=": НДС %"),t},clearFilters(){this.feelFilters(),this.confirmFilters()},confirmFilters(){this.isConfirmFilters=!0;const e={};this.filtersValue.filter((e=>null!=e.value&&""!==e.value&&e.selected)).forEach((t=>{if(1!=t.type&&2!=t.type||(e[t.code]={compare:t.option,query:t.value}),3!=t.type&&4!=t.type||(e[t.code]={compare:t.option,query:t.value}),5!=t.type&&6!=t.type&&12!=t.type||t.value?.length&&(e[t.code]={compare:"in",query:t.value}),7==t.type){const s=t.value.split("~");s.forEach(((e,t)=>s[t]=e.split("-").join("."))),e[t.code]={from:s[0],to:s[1]}}if(8==t.type){const s=t.value.split("~");s.forEach(((e,t)=>{const i=e.split("T");i[0]=i[0].split("-").join("."),s[t]=i.join(" ")})),e[t.code]={from:s[0],to:s[1]}}})),this.filter=e,this.$store.commit("updateProductsParams",{filter:e,page:1}),this.$emit("confirm")},change_filter_value(e,t){Object.assign(this.filtersValue[t],e)},setFalseIsConfirmFilters(){this.isConfirmFilters=!1},setTrueIsConfirmFilters(){this.isConfirmFilters=!0},feelFilters(){this.filtersValue=[];const e=[];this.sortedFields.forEach((t=>{let s={};s={...this.fields.filter((e=>e.code.split(".")[0]==t[0].split(".")[0]))[0]},s.type=t[1].type,s.code=t[0],e.push(s)})),e.forEach((e=>{const t=e=>{const t=[];return null!=e&&e.forEach(((e,s)=>t.push({name:e,value:s}))),t};let s=null;5!=e.type&&6!=e.type||(s=[]),9==e.type&&(s=1),12==e.type&&(s=[]);const i={type:e.type,code:e.code,option:"=",selector_options:t(e.data),value:s,table_config:e.table_config,selected:!1,name:this.searchTitle(e.code)};this.filtersValue.push(i)}))},get_categories_options(){this.$store.state.categories.fields_properties2.forEach((e=>{let t="";for(let s=1;s<e.level;s++)t+="-    ";this.categories_options.push({name:t+e.name,value:e.id})}))}}};const ps=(0,Ae.Z)(us,[["render",mt],["__scopeId","data-v-6be94ca8"]]);var _s=ps;const hs=e=>((0,l.dD)("data-v-0b660e0c"),e=e(),(0,l.Cn)(),e),vs={class:"bar_row"},gs=hs((()=>(0,l._)("th",{class:"bar_item item"},null,-1))),fs=["onClick"],ms={class:"bar_item_group"},ws={key:0,class:"bar_item_icon"},ys={key:0,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},bs=hs((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v14m4-10l-4-4M8 9l4-4"},null,-1))),ks=[bs],Cs={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},qs=hs((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v14m4-4l-4 4m-4-4l4 4"},null,-1))),Ds=[qs],xs={key:2,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Ls=hs((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m11 16l-3 3m0 0l-3-3m3 3V5m5 3l3-3m0 0l3 3m-3-3v14"},null,-1))),Ps=[Ls];function Vs(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("tr",vs,[gs,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.sortedFields,((e,t)=>((0,l.wg)(),(0,l.iD)("th",{class:"bar_item item",style:(0,n.j5)({minWidth:0!=o.width[t]?o.width[t]+"px":(o.collsCount>=8||o.collsCount,100/o.collsCount+"%")}),onClick:t=>e[1].sortable&&9!=e[1].type?o.sort(e[0]):null,key:e},[(0,l._)("div",ms,[(0,l._)("label",null,(0,n.zw)(e[1].name),1),e[1].sortable&&9!=e[1].type?((0,l.wg)(),(0,l.iD)("button",ws,[a.order.code===e[0]&&"desc"===a.order.prev_order?((0,l.wg)(),(0,l.iD)("svg",ys,ks)):a.order.code===e[0]&&"asc"===a.order.prev_order?((0,l.wg)(),(0,l.iD)("svg",Cs,Ds)):((0,l.wg)(),(0,l.iD)("svg",xs,Ps))])):(0,l.kq)("",!0)])],12,fs)))),128))])}var As={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},data(){return{order:{code:"",prev_order:""},disableExportXlsx:!1,allSelectedProducts:!1}},computed:{...(0,pe.Se)(["fields"]),collsCount(){return this.tableConfig.length},productsParams(){return this.$store.state.products.productsParams},width(){let e=[];return this.fields.forEach((t=>{let s=0;9==t.type&&(s=90),7!=t.type&&8!=t.type||(s=150),e.push(s)})),e}},methods:{isShow(e){let t=!1;return Object.entries(this.tableConfig).forEach((s=>{s[0].split(".")[0]==e&&s[1]?.visible&&(t=!0)})),t},dropOrder(){this.order={code:"",prev_order:""}},sort(e){const t=["asc","desc"];let s="";s=this.order.code===e&&this.order.prev_order==t[0]?t[1]:t[0],this.order={code:e,prev_order:s},e.split(".").length>1&&(e=e.split(".").join("->")),this.$emit("sort",e,s)},async exportXlsx(){this.disableExportXlsx=!0,this.$store.commit("openCloseTaskCenter",!0),setTimeout((()=>{this.$store.commit("openCloseTaskCenter",!1)}),5e3);const{sort:e,filter:t}=this.productsParams,s=[];Object.entries(this.tableConfig).filter((e=>e[1].visible)).sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0)).forEach((e=>s.push(e[0])));const i={sort:e,filter:t,config:s};this.$store.dispatch("exportXlsx",i)},changeAllSelectedProducts(){this.$emit("changeAllSelectedProducts",this.allSelectedProducts)},dropAllSelectedProducts(){this.allSelectedProducts=!1},openTableSettings(){this.$store.commit("open_table_settings")}}};const Ws=(0,Ae.Z)(As,[["render",Vs],["__scopeId","data-v-0b660e0c"]]);var Fs=Ws;function Ss(e,t,s,i,a,o){const d=(0,l.up)("AppPaginator"),r=(0,l.up)("ImportStuffSelector");return s.show?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,n.C_)(["bottom",{blur:s.blur}])},[s.showBtns?((0,l.wg)(),(0,l.j4)(d,{key:0,page:s.page,onChangePage:o.changePage},null,8,["page","onChangePage"])):(0,l.kq)("",!0),s.showSelector?((0,l.wg)(),(0,l.j4)(r,{key:1,class:"count",options_props:a.count_values,selected_option:{name:s.count,value:s.count},onSelect:o.change_count},null,8,["options_props","selected_option","onSelect"])):(0,l.kq)("",!0)],2)):(0,l.kq)("",!0)}const Hs=e=>((0,l.dD)("data-v-de19fd14"),e=e(),(0,l.Cn)(),e),Ts={class:"v-select"},Ys=Hs((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),Is=[Ys],js={class:"options",key:"a1"},Es=["onClick"];function Os(e,t,s,a,o,d){return(0,l.wg)(),(0,l.iD)("div",Ts,[(0,l._)("div",{class:(0,n.C_)(["title",{title_checked:a.show_options,disabled:s.disabled}]),onClick:t[0]||(t[0]=e=>a.open_close_options()),onFocusout:t[1]||(t[1]=(...e)=>a.handleFocusOut&&a.handleFocusOut(...e)),ref:"title",tabindex:"0"},[(0,l._)("p",null,(0,n.zw)(s.selected_option.name),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,n.C_)(["arrow",{rotate_arrow:a.show_options}])},Is,2))],34),(0,l.Wm)(i.uT,{name:"list"},{default:(0,l.w5)((()=>[a.show_options?((0,l.wg)(),(0,l.iD)("div",js,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.options,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.value,class:(0,n.C_)({optgroup:"optgroup"===e.value,selected:e.value==s.selected_option.value}),onClick:t=>a.select_option(e)},[e.optgroup?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Uk)("     "+(0,n.zw)(e.name),1)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Uk)((0,n.zw)(e.name),1)],64))],10,Es)))),128))])):(0,l.kq)("",!0)])),_:1})])}const $s={props:{options_props:{type:Array,default(){return[]},required:!0},selected_option:{type:Object,required:!0,default(){return{}}},disabled:{type:Boolean,required:!1,default:!1},idx:{type:Number,required:!1}},emits:{select:null},setup(e,t){const s=(0,qe.iH)([]);(0,l.bv)((()=>{window.addEventListener("scroll",c),(0,l.Y3)((()=>{i()}))}));const i=()=>{s.value=[],e.options_props?.forEach((e=>s.value.push(e)))};(0,l.YP)((()=>e.options_props),(()=>{i()}),{deep:!0});const a=(0,qe.iH)(!1);(0,l.YP)(a,(()=>t.emit("toggleShowOptions",a.value)));const o=()=>{a.value=!1},n=()=>{e.disabled||(c(),a.value=!a.value)},d=()=>{o()},r=s=>{"optgroup"!=s.value&&(t.emit("select",s,e.idx),o())};(0,l.Ah)((()=>window.removeEventListener("scroll",c)));const c=()=>{const e=u.value?.getBoundingClientRect();p.value=e.width-2+"px",_.value=e.x+"px",h.value=e.bottom+"px"},u=(0,qe.iH)(null),p=(0,qe.iH)(null),_=(0,qe.iH)(null),h=(0,qe.iH)(null);return{open_close_options:n,handleFocusOut:d,show_options:a,options:s,select_option:r,title:u,optionsWidth:p,optionsX:_,optionsY:h}}},zs=()=>{(0,i.sj)((e=>({"078e15f0":e.optionsWidth,"6af4b8ba":e.optionsX,"6af4b8bb":e.optionsY})))},Bs=$s.setup;$s.setup=Bs?(e,t)=>(zs(),Bs(e,t)):zs;var Ms=$s;const Rs=(0,Ae.Z)(Ms,[["render",Os],["__scopeId","data-v-de19fd14"]]);var Us=Rs;const Ns={class:"grid"},Zs={class:"current d"};function Ks(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("div",Ns,[s.page.current!=s.page.first&&null!=s.page.prev?((0,l.wg)(),(0,l.iD)("button",{key:0,onClick:t[0]||(t[0]=e=>i.prev()),class:"a"},(0,n.zw)("<"))):(0,l.kq)("",!0),s.page.current!=s.page.first&&s.page.prev!=s.page.first?((0,l.wg)(),(0,l.iD)("button",{key:1,onClick:t[1]||(t[1]=e=>i.first()),class:"b"},(0,n.zw)(s.page.first),1)):(0,l.kq)("",!0),s.page.current!=s.page.first&&null!=s.page.prev?((0,l.wg)(),(0,l.iD)("button",{key:2,onClick:t[2]||(t[2]=e=>i.prev()),class:"c"},(0,n.zw)(s.page.prev),1)):(0,l.kq)("",!0),(0,l._)("button",Zs,(0,n.zw)(s.page.current),1),s.page.current!=s.page.last&&null!=s.page.next?((0,l.wg)(),(0,l.iD)("button",{key:3,onClick:t[3]||(t[3]=e=>i.next()),class:"e"},(0,n.zw)(s.page.next),1)):(0,l.kq)("",!0),s.page.current!=s.page.last&&s.page.next!=s.page.last?((0,l.wg)(),(0,l.iD)("button",{key:4,onClick:t[4]||(t[4]=e=>i.last()),class:"f"},(0,n.zw)(s.page.last),1)):(0,l.kq)("",!0),s.page.current!=s.page.last&&null!=s.page.next?((0,l.wg)(),(0,l.iD)("button",{key:5,onClick:t[5]||(t[5]=e=>i.next()),class:"g"},(0,n.zw)(">"))):(0,l.kq)("",!0)])}var Gs={props:{page:Object},emits:{changePage(e){return e>0&&"number"===typeof e}},setup(e,t){const s=()=>t.emit("changePage",e.page.first),i=()=>t.emit("changePage",e.page.current-1),l=()=>t.emit("changePage",e.page.current+1),a=()=>t.emit("changePage",e.page.last);return{prev:i,first:s,next:l,last:a}}};const Xs=(0,Ae.Z)(Gs,[["render",Ks],["__scopeId","data-v-b6e7b5b2"]]);var Js=Xs,Qs={components:{ImportStuffSelector:Us,AppPaginator:Js},props:{previous:{type:Boolean,required:!1},next:{type:Boolean,required:!1},page:{type:Object,required:!1,default(){return{first:1,prev:null,current:1,next:null,last:1}}},count:{type:Number,required:!0},blur:{type:Boolean,required:!1,default:!1},show:{type:Boolean,required:!1,default:!0},showBtns:{type:Boolean,required:!1,default:!0},showSelector:{type:Boolean,required:!1,default:!0}},emits:{changePage:null,changeCount:null},data(){return{count_values:[{name:"10",value:10},{name:"20",value:20},{name:"50",value:50},{name:"200",value:200}]}},mounted(){},computed:{},methods:{changePage(e){this.$emit("changePage",e)},change_count(e){this.$emit("changeCount",e.name)}}};const ei=(0,Ae.Z)(Qs,[["render",Ss],["__scopeId","data-v-2b2b5832"]]);var ti=ei,si={name:"MainGrid",components:{MainGridFilters:_s,MainGridBar:Fs,GridBottom:ti,AppInputSelect:Fe},props:{},emits:{accept:null},data(){return{isLoading:!1,inputValues:[],allWhsList:[],savedAllWhsList:[],showSpinner:!1}},computed:{page(){const e={first:this.getPageFromLink(this.meta?.links?.first),prev:this.getPageFromLink(this.meta?.links?.prev),current:this.meta?.meta?.current_page,next:this.getPageFromLink(this.meta?.links?.next),last:this.getPageFromLink(this.meta?.links?.last)};return e},count(){return this.productsParams?.per_page},meta(){return this.$store.state.products.meta},products(){return this.$store.state.products.allProducts},productsParams(){return this.$store.state.products.productsParams},all_fields(){return this.$store.state.fields.all_fields},tableConfig(){return this.$store.state.fields.tableConfig},sortedFields(){const e=Object.entries(this.tableConfig);return e.sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0)).filter((e=>e[1].visible))},categories(){const e={};return this.$store.state.categories.fields_properties2.forEach((t=>e[t.id]=t.name)),e},savedAllWhsListIds(){const e=[];return this.savedAllWhsList.forEach((t=>e.push(t[0].product_id))),e}},async activated(){this.isLoading=!0,await Promise.all([this.$store.dispatch("getTableConfig",{account_id:30214471,code:""}),this.$store.dispatch("get_fields_properties2",{account_id:30214471}),this.$store.dispatch("getAllFields",{account_id:30214471}),this.get_products(this.productsParams)]),this.isLoading=!1},deactivated(){},watch:{products:{handler:function(){this.fillAllWhsList()},deep:!0},allWhsList:{handler:function(){this.saveAllWhsList()},deep:!0}},methods:{accept(){this.savedAllWhsList.forEach((e=>{e?.forEach((e=>{if(e.specialValue){const t={account_id:30214471,productId:e.is_service?e.product_id:e.product_id+"%%%"+e.code,count:e.specialValue};this.$store.dispatch("addProduct2",t)}}))})),this.savedAllWhsList=[],this.$emit("accept")},fillAllWhsList(){this.saveAllWhsList();const e=[];this.products.forEach((t=>{const s=this.savedAllWhsList.find((e=>e[0].product_id===t.id));if(s)e.push(s);else{const s=t.whs?.map((e=>({...e})));s.map((e=>{e.name=e.name+"   |   "+e.count,e.value=e.code,e.specialValue=null,e.product_id=t.id,e.is_service=t.is_service,e.product_name=t.fields?.name})),e.push(s)}})),this.allWhsList=e},saveAllWhsList(){const e=this.allWhsList.filter((e=>{const t=e.reduce(((e,t)=>e+Number(t.specialValue)),0);return t}));if(this.savedAllWhsList.length){const t={};this.savedAllWhsList.forEach(((s,i)=>{const l=s[0].product_id;e.forEach((e=>{e[0].product_id===l?this.savedAllWhsList[i]=e:this.savedAllWhsListIds.includes(e[0].product_id)||(t[e[0].product_id]=e)}))})),this.savedAllWhsList=[...this.savedAllWhsList,...Object.values(t)],this.savedAllWhsList=this.savedAllWhsList.filter((e=>e.reduce(((e,t)=>e+Number(t.specialValue)),0)))}else this.savedAllWhsList=[...this.savedAllWhsList,...e];this.$emit("changeSavedAllWhsList",this.savedAllWhsList)},deleteSavedAllWhsList(e){this.savedAllWhsList.splice(e,1),this.$emit("changeSavedAllWhsList",this.savedAllWhsList)},fillInputValues(){this.products.forEach((()=>this.inputValues.push("")))},getPageFromLink(e){return e?e.split("?page=")[1]:null},async clearFilters(){await(this.filters?.clearFilters()),this.filters?.confirmFilters()},confirmFilters(){this.filters?.confirmFilters()},async changeCount(e){this.$store.commit("updateProductsParams",{per_page:e}),this.drop_page()},changePage(e){const t={page:e};this.$store.commit("updateProductsParams",t),this.get_products(this.productsParams)},async get_products(e){this.showSpinner=!0,await this.$store.dispatch("getAllProducts",{...e,account_id:30214471,leadId:29768593}),this.fillInputValues(),this.showSpinner=!1},drop_page(){this.changePage(1)},sort(e,t){const s={page:1,sort:{by:e,order:t}};this.$store.commit("updateProductsParams",s),this.get_products(this.productsParams)}}};const ii=(0,Ae.Z)(si,[["render",nt],["__scopeId","data-v-25204af6"]]);var li=ii,ai={components:{MainGrid:li},emits:{close:null},setup(e,t){const s=()=>{t.emit("close")},i=()=>{s()},a=(0,qe.iH)([]),o=e=>a.value=[...e],n=(0,qe.iH)(null),d=e=>{n.value&&(0,l.Y3)((()=>n.value?.deleteSavedAllWhsList(e)))},r=()=>{n.value&&(0,l.Y3)((()=>n.value?.accept()))};return{close:s,accept:i,accepMainGridRef:r,savedAllWhsList:a,changeSavedAllWhsList:o,mainGridRef:n,deleteSavedAllWhsList:d}}};const oi=(0,Ae.Z)(ai,[["render",Me],["__scopeId","data-v-3a71306a"]]);var ni=oi,di={components:{AppInputSelect:Fe,FiltersModal:ni},data(){return{show_cards:!1,show_filters:!1,selectedCategories:[],search:{value:"",list:[]},inputValues:[],allWhsList:[],showSpinner:!1}},computed:{...(0,pe.Se)(["data","params"]),categories(){return this.$store.state.categories.categories},products(){return this.$store.state.products.products},fields(){return this.$store.state.fields.fields},sortedFields(){return this.fields?.filter((e=>e.lead_config?.visible>0))}},async mounted(){console.debug("amoWidjetSelf",Di),await Promise.all([this.getCategories(0),this.$store.dispatch("getAllFields",{account_id:30214471})]),this.selectCategories(this.categories[0])},watch:{async show_cards(){this.show_cards||(this.selectedCategories=[],await this.getCategories(0))}},methods:{fillAllWhsList(){const e=[];this.products.forEach((t=>{const s=t.whs?.map((e=>({...e})));s.map((e=>{e.name=e.name+"   |   "+e.count,e.value=e.code,e.specialValue=null})),e.push(s)})),this.allWhsList=e},fillInputValues(){this.products.forEach((()=>this.inputValues.push("")))},addToLeadAutocomplete(e){this.$store.dispatch("addProduct",{account_id:30214471,productId:e})},addToLead(e){const t=this.products.find((t=>t.id===e)),s=this.products.indexOf(t);t.is_service?this.$store.dispatch("addProduct2",{account_id:30214471,productId:e,count:this.allWhsList[s][0].specialValue}):this.allWhsList[s].forEach((t=>{0!==t.specialValue&&this.$store.dispatch("addProduct2",{account_id:30214471,productId:[e,t.code].join("%%%"),count:t.specialValue})}))},async getProductsAutocomplete(e){this.search.value=e;const t=this.selectedCategories.at(-1)?.id,s={account_id:30214471,q:e};t&&(s.category_id=t),await this.$store.dispatch("getProductsAutocomplete",s);const i=this.$store.state.products.productsAutocomplete;i.map((e=>e.name=e.label)),this.search.list=i},async selectCategories(e){this.showSpinner=!0;const t=this.selectedCategories?.indexOf(e);-1!==t&&this.selectedCategories.splice(t,9999),this.selectedCategories.push(e),await Promise.all([this.getCategories(e.id),this.getProducts(e.id)]),1===this.selectedCategories.length&&await this.getFields(e.id),this.showSpinner=!1},async getCategories(e){await this.$store.dispatch("getCategories",{account_id:30214471,parent_id:e})},async getProducts(e){await this.$store.dispatch("getProducts",{account_id:30214471,category_id:e}),this.fillInputValues(),this.fillAllWhsList()},async getFields(e){await this.$store.dispatch("getFields",{account_id:30214471,category_id:e,with_parents:1})},handleDeleteItem(e,t){const s={name:this.short_value(e),data:e,value:Math.random()};this.available_data.push(s),this.rows.splice(t,1),this.countes.splice(t,1)},update_changeValue(e,t){e.forEach(((e,s)=>{if(!this.rows.includes(e)){let i=[];e.forEach((e=>i.push(e))),this.rows.push(i);let l=null;l=void 0==t[s]?0:t[s];const a={count:l,company:""};this.countes.push(a)}}))},close_filters(){this.show_filters=!1},select(e){this.available_data.forEach(((t,s)=>{t.data==e.data&&this.available_data.splice(s,1)})),this.rows.push(e.data);const t={count:1,company:""};this.countes.push(t)},feel_available_data(){this.data.forEach(((e,t)=>{const s={name:this.short_value(e),data:e,value:t};this.available_data.push(s)}))},search_value(e,t){const s=this.search_idx(e);if(-2!=s)return t[s]},search_idx(e){const t=this.params.indexOf(e)-1;return t},toggleShowData(e){const t=this.show_data[e];this.show_data=[],this.show_data[e]=!t},openModal(){return this.show_filters=!0,!1}}};const ri=(0,Ae.Z)(di,[["render",ue],["__scopeId","data-v-678f9d08"]]);var ci=ri,ui={name:"App",components:{MainPage:ci},setup(){}};const pi=(0,Ae.Z)(ui,[["render",o]]);var _i=pi,hi={state:{params:["","Название","Артикул","Себестоимость","Цена","Склад","На складе","Свободно для резерва","В резерве","№ партии","Поступление","НДС","Изменение","Единицы измерений","НДС %","НДС включен в цену","Менеджер может менять % НДС","Описание","Прибыль","Группа",""],data:[["Товар 1","1","500","509","Склад 1","509","50","51","1","2022-07-13","Да","2022-07-18T11:21","шт","3","Да","Да","123","Да","Группа 1"],["Товар 1","1","120","129","Склад 1","129","12","11","2","2022-07-13","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 1","1","300","309","Склад 1","309","30","31","2","2022-07-13","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 1","1","1500","1509","Склад 1","1509","150","151","3","2022-07-13","Да","2022-07-18T11:21","шт","3","Да","Да","123","Да","Группа 1"],["Товар 2","2","1800","1809","Склад 1","1809","180","181","1","2022-07-14","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 3","3","13","19","Склад 1","19","1","1","2","2022-07-18","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 4","4","117","119","Склад 1","119","11","11","3","2022-07-13","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 1"],["Товар 5","5","4356","4359","Склад 2","4359","435","431","2","2022-07-18","Да","2022-07-18T11:21","шт","3","Да","Да","123","Да","Группа 2"],["Товар 6","6","67589","67589","Склад 2","67589","6758","6751","2","2022-07-11","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"],["Товар 7","7","123","129","Склад 2","129","12","11","1","2022-07-11","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"],["Товар 8","8","123","129","Склад 2","129","12","11","1","2022-07-18","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"],["Товар 9","9","123","129","Склад 2","129","12","11","2","2022-07-11","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"],["Товар 9","9","123","129","Склад 2","129","12","11","3","2022-07-28","Да","2022-07-18T11:21","шт","3","Да","Да","123","Да","Группа 2"],["Товар 10","10","123","129","Склад 2","129","12","11","3","2022-07-16","Да","2022-07-18T11:21","шт","3","Нет","Да","123","Да","Группа 2"]],service:[["Услуга 1","1","1500","1509","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 1"],["Продажа","1","1500","1509","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 1"],["Услуга 2","2","1800","1809","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 1"],["Услуга 3","3","13","19","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 1"],["Услуга 1","1","1500","1509","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","1234","Да","Группа 2"],["Услуга 1","1","1500","1509","","","","","","2022-07-18","Да","2022-07-18T11:21","","3","Нет","Да","123","Да","Группа 2"]],types:[{name:"Число целое",value:1},{name:"Дробное число",value:2},{name:"Строка",value:3},{name:"Текст",value:4},{name:"Список",value:5},{name:"Мильтисписок",value:6},{name:"Дата",value:7},{name:"Дата-Время",value:8},{name:"Флаг",value:9}],fields:[{id:1,field:"Название",type:{name:"Строка",value:3},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:2,field:"Артикул",type:{name:"Строка",value:3},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:3,field:"Себестоимость",type:{name:"Дробное число",value:2},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:4,field:"Цена",type:{name:"Дробное число",value:2},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:5,field:"Склад",type:{name:"Список",value:5},selector_options:[{name:"Не выбрано",value:1},{name:"Склад 1",value:2},{name:"Склад 2",value:3}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:6,field:"На складе",type:{name:"Число целое",value:1},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:7,field:"Свободно для резерва",type:{name:"Число целое",value:1},selector_options:[{name:"",value:1}],disable_change_type:!1,visibility:!0,edit:!1,editing:!1,delete:!0,available_to_services:!1},{id:8,field:"В резерве",type:{name:"Число целое",value:1},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:9,field:"№ партии",type:{name:"Число целое",value:1},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:10,field:"Поступление",type:{name:"Дата",value:7},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:11,field:"НДС",type:{name:"Флаг",value:9},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:12,field:"Изменение",type:{name:"Дата-Время",value:8},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:13,field:"Единицы измерений",type:{name:"Список",value:5},selector_options:[{name:"Не выбрано",value:1},{name:"шт",value:2},{name:"л (литры)",value:3},{name:"м3 (кубические метры)",value:4},{name:"кг (килограммы)",value:5},{name:"т (тонны)",value:6},{name:"комплект",value:7},{name:"услуга",value:8}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!1},{id:14,field:"НДС %",type:{name:"Дробное число",value:2},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:15,field:"НДС включен в цену",type:{name:"Флаг",value:9},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:16,field:"Менеджер может менять % НДС",type:{name:"Флаг",value:9},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:17,field:"Описание",type:{name:"Текст",value:4},selector_options:[{name:"",value:1}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0},{id:18,field:"Прибыль",type:{name:"Флаг",value:9},selector_options:[{name:"",value:1}],disable_change_type:!1,visibility:!1,edit:!1,editing:!1,delete:!0,available_to_services:!0},{id:19,field:"Группа",type:{name:"Мильтисписок",value:6},selector_options:[{name:"Не выбрано",value:1},{name:"Группа 1",value:2},{name:"Группа 2",value:3},{name:"Группа 3",value:4},{name:"Группа 4",value:5}],disable_change_type:!0,visibility:!0,edit:!1,editing:!1,delete:!1,available_to_services:!0}]},getters:{data(e){return e.data},data1(e){return e.data},get_data_storage(e){const t=e.params.indexOf("Склад")-1,s={};let i=[],l=null;return e.fields.forEach((e=>{"Склад"==e.field&&(l=e.id-1)})),e.fields[l].selector_options.forEach((e=>{i.push(e.name)})),i.shift(),i.forEach((e=>{s[e]=[]})),i.forEach((i=>{e.data.forEach((e=>{e[t]==i&&s[i].push(e)}))})),s},service(e){return e.service},params(e){return e.params},types(e){return e.types},fields(e){return e.fields},options_from_name:e=>{const t={};return e.fields.forEach((e=>{t[e.field]=e.selector_options})),t}},mutations:{update_data(e,t){e.data=t},update_data_idx(e,t){e.data[t.idx]=t.data},update_all_data(e,t){e.data.forEach(((s,i)=>{e.data[i].push(t)}))},add_new_data(e,t){let s=[];e.params.forEach((()=>s.push(""))),s.pop(),s.pop(),t.title.forEach(((i,l)=>{const a=e.params.indexOf(i)-1;a>=0&&(s[a]=t.new_data[l])})),e.data.push(s)},cancel_item_in_data(e,t){const s=e.params.indexOf(t.name)-1,i=e.data[t.idx][s];e.data[t.idx][s]=i-t.count},delete_data_idx(e,t){e.data.forEach(((s,i)=>{t.forEach((t=>{e.data[i].splice(t,1)}))}))},remove_data_idx(e,t){e.data.splice(t.idx,1)},add_data(e,t){e.data.push(t.data)},archive_data(e,t){t.forEach((t=>{e.archive.items.push(e.data[t]),e.archive.sourses.push(0)}));const s=t.reverse();s.forEach((t=>e.data.splice(t,1)))},update_params(e,t){e.params=t},update_fields(e,t){e.fields=t}},actions:{}};function vi(){const e=e=>{let t="";return Object.entries(e).forEach(((e,s)=>{t+=0===s?"?":"&",t+=e[0]+"="+e[1]})),t};return{preparation_params:e}}const{preparation_params:gi}=vi();var fi={state:{categories:[],fields_properties:[],fields_properties2:[]},getters:{},mutations:{updateCategories(e,t){e.categories=[...t]},update_fields_properties(e,t){e.fields_properties=[...t]},update_fields_properties2(e,t){e.fields_properties2=[...t]}},actions:{async getCategories(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Di?.apiRequest("categories",t,(async t=>{console.debug(t),i=await t,e.commit("updateCategories",i),s(i)}))})()}));return s},async get_fields_properties(e,t){let s=[];return delete t.account_id,delete t.user,Di?.apiRequest("category/list",t,(t=>{s=t,console.debug(s),e.commit("update_fields_properties",s)})),s},async get_fields_properties2(e,t){let s=[];return delete t.account_id,delete t.user,Di?.apiRequest("categories/list",t,(t=>{s=t,console.debug(s),e.commit("update_fields_properties2",s)})),s}}};function mi(){const e=e=>(e.map((e=>{qi.state.fields?.all_fields.forEach((t=>{null!==e.fields&&void 0!==e.fields||(e.fields={}),1!==t.type&&2!==t.type||(void 0===e.fields?.[t.code]||null===e.fields?.[t.code]?e.fields[t.code]=0:e.fields[t.code]=Number(e.fields[t.code])),3!==t.type&&4!==t.type||(void 0===e.fields?.[t.code]||null===e.fields?.[t.code]?e.fields[t.code]="":e.fields[t.code]=String(e.fields[t.code])),5!==t.type&&6!==t.type||void 0!==e.fields?.[t.code]&&null!==e.fields?.[t.code]||(e.fields[t.code]=""),7!==t.type&&8!==t.type||void 0!==e.fields?.[t.code]&&null!==e.fields?.[t.code]||(e.fields[t.code]=""),9===t.type&&(void 0===e.fields?.[t.code]||null===e.fields?.[t.code]?e.fields[t.code]=!1:("0"===e.fields?.[t.code]&&(e.fields[t.code]=!1),"1"===e.fields?.[t.code]?e.fields[t.code]=!0:e.fields[t.code]=Boolean(e.fields[t.code]))),11===t.type&&(void 0!==e.fields?.[t.code]&&null!==e.fields?.[t.code]||(e.fields[t.code]={cost:0,currency:"RUB",is_manager_can_change_nds:!1,is_nds:!1,is_price_include_nds:!1,nds:0}),void 0===e.fields[t.code]?.cost||null===e.fields[t.code]?.cost?e.fields[t.code].cost=0:e.fields[t.code].cost=Number(e.fields[t.code].cost),void 0===e.fields[t.code]?.currency||null===e.fields[t.code]?.currency?e.fields[t.code].currency="":e.fields[t.code].currency=String(e.fields[t.code].currency),void 0===e.fields[t.code]?.is_manager_can_change_nds||null===e.fields[t.code]?.is_manager_can_change_nds?e.fields[t.code].is_manager_can_change_nds=!1:("0"===e.fields[t.code].is_manager_can_change_nds&&(e.fields[t.code].is_manager_can_change_nds=!1),"1"===e.fields[t.code].is_manager_can_change_nds?e.fields[t.code].is_manager_can_change_nds=!0:e.fields[t.code].is_manager_can_change_nds=Boolean(e.fields[t.code].is_manager_can_change_nds)),void 0===e.fields[t.code]?.is_nds||null===e.fields[t.code]?.is_nds?e.fields[t.code].is_nds=!1:("0"===e.fields[t.code].is_nds&&(e.fields[t.code].is_nds=!1),"1"===e.fields[t.code].is_nds?e.fields[t.code].is_nds=!0:e.fields[t.code].is_nds=Boolean(e.fields[t.code].is_nds)),void 0===e.fields[t.code]?.is_price_include_nds||null===e.fields[t.code]?.is_price_include_nds?e.fields[t.code].is_price_include_nds=!1:("0"===e.fields[t.code].is_price_include_nds&&(e.fields[t.code].is_price_include_nds=!1),"1"===e.fields[t.code].is_price_include_nds?e.fields[t.code].is_price_include_nds=!0:e.fields[t.code].is_price_include_nds=Boolean(e.fields[t.code].is_price_include_nds)),void 0===e.fields[t.code]?.nds||null===e.fields[t.code]?.nds?e.fields[t.code].nds=0:e.fields[t.code].nds=Number(e.fields[t.code].nds)),13===t.type&&(void 0!==e.fields?.[t.code]&&null!==e.fields?.[t.code]||(e.fields[t.code]={count:0,reserve:0}),void 0===e.fields[t.code]?.count||null===e.fields[t.code]?.count?e.fields[t.code].count=0:e.fields[t.code].count=Number(e.fields[t.code].count),void 0===e.fields[t.code]?.reserve||null===e.fields[t.code]?.reserve?e.fields[t.code].reserve=0:e.fields[t.code].reserve=Number(e.fields[t.code].reserve))}))})),e);return{preparationProducts:e}}const{preparationProducts:wi}=mi(),{preparation_params:yi}=vi();var bi={state:{products:[],productsAutocomplete:[],allProducts:[],meta:{links:{},meta:{}},productsParams:{page:1,filter:{},sort:{},per_page:20}},getters:{},mutations:{updateProducts(e,t){e.products=[...t]},updateProductsAutocomplete(e,t){e.productsAutocomplete=[...t]},updateAllProducts(e,t){e.allProducts=[...wi(t)]},update_meta(e,t){e.meta={...t}},updateProductsParams(e,t){Object.assign(e.productsParams,t)}},actions:{async getProductsAutocomplete(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Di?.apiRequest("get-products-autocomplete",t,(async t=>{console.debug(t,Array.isArray(t)),i=await t,e.commit("updateProductsAutocomplete",i),s(i)}))})()}));return s},async getProducts(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,Di?.apiRequest("products",t,(async t=>{console.debug(t),e.commit("updateProducts",t),i=await t,s(i)}))})()}));return s},async getAllProducts(e,t){const s=await new Promise((s=>{let i=[];(async()=>{delete t.account_id,delete t.user,delete t.leadId,t.leadId=Di?.AMOCRM.data.current_card.id,Di?.apiRequest("products/filtered",t,(async t=>{i=await t,console.debug(i),e.commit("updateAllProducts",i.data),e.commit("update_meta",{links:i.links,meta:i.meta}),s(i)}))})()}));return s},async addProduct(e,t){let s=[];return delete t.account_id,delete t.user,Di?.addProduct(Di?.AMOCRM?.data?.current_card?.id,t.productId),s},async addProduct2(e,t){let s=[];return delete t.account_id,delete t.user,Di?.addProduct2(Di?.AMOCRM?.data?.current_card?.id,t.productId,t.count),s}}};const{preparation_params:ki}=vi();var Ci={state:{fields:[],all_fields:[],tableConfig:{}},getters:{},mutations:{updateFields(e,t){e.fields=[...t]},updateTableConfig(e,t){e.tableConfig={...t}},update_all_fields(e,t){const s=t.sort(((t,s)=>e.tableConfig[t.code]?.sort>e.tableConfig[s.code]?.sort?1:e.tableConfig[t.code]?.sort==e.tableConfig[s.code]?.sort?0:e.tableConfig[t.code]?.sort<e.tableConfig[s.code]?.sort?-1:void 0));e.all_fields=[...s]}},actions:{async getFields(e,t){console.debug("production",Di);let s=[];return delete t.account_id,delete t.user,Di?.apiRequest("fields",t,(t=>{console.debug(t),s=t,e.commit("updateFields",s)})),s},async getAllFields(e,t){let s=[];return delete t.account_id,delete t.user,Di?.apiRequest("fields/all",t,(t=>{console.debug(t),s=t,e.commit("update_all_fields",s)})),s},async getTableConfig(e,t){let s=[];return delete t.account_id,delete t.user,Di?.apiRequest("products/filtered/config",t,(t=>{console.debug(t),s=t,e.commit("updateTableConfig",s?.table)})),s}}},qi=(0,pe.MT)({modules:{data:hi,categories:fi,products:bi,fields:Ci}});let Di=null;const xi={render(e){return Di=e,e.showProductsSearch((e=>{const t=(0,i.ri)({render:()=>(0,l.h)(_i)});t.use(qi),t.mount(e)})),e.apiRequest("fields",{category_id:0},(e=>{console.debug(e)})),!0},init(){return!0},bind_actions(){return!0},settings(){},onSave(){},destroy(){},contacts_selected(){},leads_selected(){},tasks_selected(){}};$("body").data("WidgetVueProductsSearch",xi);var Li=xi;(0,i.ri)(_i).use(qi).mount("#test")}},t={};function s(i){var l=t[i];if(void 0!==l)return l.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,i,l,a){if(!i){var o=1/0;for(c=0;c<e.length;c++){i=e[c][0],l=e[c][1],a=e[c][2];for(var n=!0,d=0;d<i.length;d++)(!1&a||o>=a)&&Object.keys(s.O).every((function(e){return s.O[e](i[d])}))?i.splice(d--,1):(n=!1,a<o&&(o=a));if(n){e.splice(c--,1);var r=l();void 0!==r&&(t=r)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[i,l,a]}}(),function(){s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={179:0};s.O.j=function(t){return 0===e[t]};var t=function(t,i){var l,a,o=i[0],n=i[1],d=i[2],r=0;if(o.some((function(t){return 0!==e[t]}))){for(l in n)s.o(n,l)&&(s.m[l]=n[l]);if(d)var c=d(s)}for(t&&t(i);r<o.length;r++)a=o[r],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(c)},i=self["webpackChunkwidget_test_3"]=self["webpackChunkwidget_test_3"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(871)}));return i=s.O(i),i}()}));
//# sourceMappingURL=main.js.map